(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    246071,       6956]
NotebookOptionsPosition[    226442,       6673]
NotebookOutlinePosition[    226805,       6689]
CellTagsIndexPosition[    226762,       6686]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Speciation with two resources", "Title",
 CellChangeTimes->{{3.791633093987832*^9, 
  3.7916330993078423`*^9}},ExpressionUUID->"84dec8b2-c688-4eb4-85f0-\
d40939781ab5"],

Cell[CellGroupData[{

Cell["Sympatric speciation", "Section",
 CellChangeTimes->{{3.792761556047909*^9, 
  3.792761571985756*^9}},ExpressionUUID->"8c73b69b-61f6-4a4b-9a00-\
8a2e97ededab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.792761708495614*^9, 3.792761710566682*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f18cc945-6a07-418a-81ce-08cd4d29bda4"],

Cell[TextData[{
 "A population of organisms has access to two resources in one habitat patch. \
The population reproduces asexually and is monomorphic with respect to an \
ecological trait, ",
 StyleBox["x",
  FontSlant->"Italic"],
 ", which determines  the resource utilization of the individuals. A mutant \
with trait value ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "m"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4d1ad3c1-b446-40dd-8286-da4e95a469d1"],
 ", when rare, has the following population dynamics in the resident \
population with trait value ",
 StyleBox["x",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.792761713204699*^9, 
  3.792761845795775*^9}},ExpressionUUID->"da17f822-7f14-4d96-94c7-\
bebb4ac4b2b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dM", " ", "=", " ", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"xm", ",", " ", "x"}], "]"}], " ", "M"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792761584543885*^9, 3.792761587380509*^9}, {
  3.792761665952182*^9, 3.792761698628532*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"86ffc445-ee1e-4f82-ba77-f1d2af9307a1"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0ccbdd4d-a04c-4bb7-87e8-e70fd8864020"],
 StyleBox[") ",
  FontSlant->"Italic"],
 "is the per capita growth rate, given by"
}], "Text",
 CellChangeTimes->{{3.792761854490963*^9, 
  3.792761888926918*^9}},ExpressionUUID->"78720b15-e4a2-4fdd-ab65-\
4284d3e4ef4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{"W", "[", 
     RowBox[{"xm", ",", " ", "x"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7927618903028107`*^9, 3.792761921361408*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"bdfb37fb-7795-45fd-b6a7-4ccd27bebfb7"],

Cell[TextData[{
 "where ",
 StyleBox["d",
  FontSlant->"Italic"],
 " is the per capita death rate and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "414c5f5e-4f1c-4473-ad53-25eb3a815fc9"],
 StyleBox[") ",
  FontSlant->"Italic"],
 "is the per capita birth rate of the mutant, "
}], "Text",
 CellChangeTimes->{{3.792761925212462*^9, 
  3.7927619670835114`*^9}},ExpressionUUID->"ed0a3f17-c0e9-418d-ade1-\
1f965218bacf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["e", "1"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "1"], "[", "x", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["e", "2"], "[", "xm", "]"}], 
     RowBox[{
      SubscriptBox["R", "2"], "[", "x", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792761970021832*^9, 3.7927620005479097`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0a4fa64b-5058-4da9-9bbc-beef7a4bd525"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["e", "i"], "(", 
    SubscriptBox["x", "m"], ")"}], TraditionalForm]],ExpressionUUID->
  "3dcb8c26-9a29-4286-9233-87050f8c0e40"],
 " is the attack rate of an individual with trait value ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "m"], TraditionalForm]],ExpressionUUID->
  "3d581ab6-8ea7-4c5d-9565-e4a4db4146c4"],
 " on resource ",
 StyleBox["i",
  FontSlant->"Italic"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "i"], "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "886ae042-0fb4-4e82-9aee-0897d18cd662"],
 " is the equilibrium concentration of resource ",
 StyleBox["i",
  FontSlant->"Italic"],
 " in the habitat. Here, we assume that the mutants are rare enough that only \
the resident population affects the dynamics of the limited resources. In a \
population with trait value ",
 StyleBox["x",
  FontSlant->"Italic"],
 " the resources unfold according to the following dynamics:"
}], "Text",
 CellChangeTimes->{{3.792762003651924*^9, 3.792762126431151*^9}, {
  3.792762179456614*^9, 
  3.792762190485973*^9}},ExpressionUUID->"9a378a22-3125-4236-882f-\
acccaec36285"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "1"], "=", 
   RowBox[{"a", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], "[", "x", "]"}], "N"}]}], ")"}], " ", 
     SubscriptBox["R", "1"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "2"], "=", 
   RowBox[{
    RowBox[{"h", " ", "a"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "2"], "[", "x", "]"}], "N"}]}], ")"}], " ", 
     SubscriptBox["R", "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7927621287003937`*^9, 3.792762222226678*^9}, {
  3.7927622555183268`*^9, 3.792762257499692*^9}, {3.7929246150707006`*^9, 
  3.792924622134736*^9}},ExpressionUUID->"f57c2f21-692a-4a9d-8108-\
03f137fc2153"],

Cell[TextData[{
 "where ",
 StyleBox["a",
  FontSlant->"Italic"],
 " is the rate of inflow the resource, ",
 StyleBox["b",
  FontSlant->"Italic"],
 " is the relative outflow rate, ",
 StyleBox["h",
  FontSlant->"Italic"],
 " is the degree of symmetry in inflow between the two resources and ",
 StyleBox["N",
  FontSlant->"Italic"],
 " is the population density of the resident. Assuming that the dynamics of \
the resource are fast relative to the population, the equilibrium resource \
concentrations are"
}], "Text",
 CellChangeTimes->{{3.792762247281702*^9, 3.7927622900243473`*^9}, {
  3.7927625414805*^9, 3.792762596649596*^9}, {3.7928271489207363`*^9, 
  3.792827170604534*^9}},ExpressionUUID->"959937e3-b810-43a2-bd82-\
97fc3fdaba39"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Req", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["dR", "1"], "\[Equal]", 
        SubscriptBox["R", "1"]}], ",", 
       RowBox[{
        SubscriptBox["dR", "2"], "\[Equal]", 
        SubscriptBox["R", "2"]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["R", "1"], ",", " ", 
       SubscriptBox["R", "2"]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "1"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "1"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "2"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "2"], "/.", "Req"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7927625618544607`*^9, 3.7927625699313803`*^9}, {
  3.792762600814623*^9, 3.792762738688274*^9}, {3.7927633124660473`*^9, 
  3.7927633125883017`*^9}, {3.792764030476071*^9, 3.792764116044623*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"d2c811c2-82be-46f8-8f92-c1aa0e38adfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["R", "1"], "\[Rule]", 
    FractionBox["a", 
     RowBox[{"1", "+", 
      RowBox[{"b", " ", "N"}], "+", 
      RowBox[{"N", " ", 
       RowBox[{
        SubscriptBox["e", "1"], "[", "x", "]"}]}]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "2"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", "h"}], 
     RowBox[{"1", "+", 
      RowBox[{"b", " ", "N"}], "+", 
      RowBox[{"N", " ", 
       RowBox[{
        SubscriptBox["e", "2"], "[", "x", "]"}]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.79276263059051*^9, 3.792762650276819*^9}, {
   3.7927627082936497`*^9, 3.792762735402124*^9}, 3.792762766262611*^9, 
   3.792763982503459*^9, {3.7927640337280817`*^9, 3.792764080626457*^9}, 
   3.7927641175102587`*^9, 3.792827181632766*^9, 3.7928274819983788`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"768e77c3-4473-4ad5-a4b4-9a24a31a0f81"]
}, Open  ]],

Cell["The attack rates are given by", "Text",
 CellChangeTimes->{{3.792762844185622*^9, 
  3.792762849712101*^9}},ExpressionUUID->"07043a38-ccbf-413b-a095-\
4f097957f42b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "1"], "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "+", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "2"], "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "-", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.792762839135212*^9, 3.7927628400007067`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"63c6cb21-962d-4d57-ac76-9d6d22e7f8f3"],

Cell["\<\
The invasion fitness of the mutant is its long-term per capita growth rate\
\>", "Text",
 CellChangeTimes->{{3.792762952590124*^9, 3.792762985660226*^9}, {
  3.792763670313043*^9, 
  3.7927636745536833`*^9}},ExpressionUUID->"42bb344b-d95a-4d0b-8eac-\
b9eea8b52be7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"r", "[", 
     RowBox[{"xm", ",", " ", "x"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792762992014811*^9, 3.792763023212228*^9}, {
   3.792764204946474*^9, 3.792764212725587*^9}, 3.79282745433852*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"49dc744f-72eb-44ac-bf6a-7fb12a980266"],

Cell["\<\
The fitness gradient is the derivative of the invasion fitness with respect \
to the mutant phenotype, evaluated at the resident phenotype\
\>", "Text",
 CellChangeTimes->{{3.792763679096746*^9, 
  3.792763700130118*^9}},ExpressionUUID->"fbf71420-6237-4183-a16d-\
e8143867a24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grad", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Lambda]", ",", " ", "xm"}], "]"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7927637041391487`*^9, 3.792763715720483*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"da2c8f8b-b9e4-4180-85a7-7acaba99b6b7"],

Cell[TextData[{
 "Evolutionary singularities are values of the trait ",
 StyleBox["x",
  FontSlant->"Italic"],
 " for which the population is at an equilibrium where the mutant is absent \
and the fitness gradient is zero. We find them by solving the following \
system:"
}], "Text",
 CellChangeTimes->{{3.7927637262760973`*^9, 3.79276376622189*^9}, {
  3.792763799989513*^9, 
  3.792763875965021*^9}},ExpressionUUID->"df5b2abe-ef83-4fc0-9c6c-\
2c6b6e350c35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dN", "=", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"x", ",", "x"}], "]"}], "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dM", "=", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"xm", ",", "x"}], "]"}], "M"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamics", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dN", "\[Equal]", "N"}], ",", " ", 
     RowBox[{"dM", "\[Equal]", "M"}], ",", " ", 
     RowBox[{"grad", "\[Equal]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792763880336713*^9, 3.792763953757162*^9}, {
  3.792764310929534*^9, 3.792764339736803*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"9b18e44b-5054-4e9c-a37f-66a5df97079b"],

Cell["We can solve the dynamics under some parameter values", "Text",
 CellChangeTimes->{{3.7927644550381813`*^9, 
  3.792764466683144*^9}},ExpressionUUID->"9f9ddaa3-e646-4724-8fca-\
03ee9a2e334f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "100"}], ",", 
     RowBox[{"b", "\[Rule]", "30"}], ",", 
     RowBox[{"d", "\[Rule]", "0.2"}], ",", " ", 
     RowBox[{"h", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"s", "\[Rule]", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792764141951068*^9, 3.7927641636042757`*^9}, {
  3.7927644198161182`*^9, 3.792764423395487*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"749e56df-5e3a-4817-91fd-0364bc029306"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dynamics", "/.", "pars"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", ",", " ", "10000"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"M", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.792764137456121*^9, 3.792764138114235*^9}, {
  3.792764227343296*^9, 3.7927642431202927`*^9}, {3.7927642785848083`*^9, 
  3.79276430507629*^9}, {3.792764370538261*^9, 3.7927643955079947`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"35c61bbc-2d02-49e6-85ff-841bdce8479b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"N", "\[Rule]", "16.429600265662277`"}], ",", 
   RowBox[{"M", "\[Rule]", "0.`"}], ",", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"-", "0.9558748390255608`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7927641385578403`*^9, 3.792764168926646*^9, {3.7927642214518127`*^9, 
   3.7927642280893*^9}, {3.792764374681881*^9, 3.792764395943102*^9}, 
   3.792764439427535*^9, 3.792827213226714*^9, {3.7928274651927958`*^9, 
   3.792827491735458*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"25d74fcd-45f0-43a7-b71d-e1c7a8f78f65"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Structured population", "Section",
 CellChangeTimes->{{3.791710567622795*^9, 
  3.791710585553315*^9}},ExpressionUUID->"659977b2-8cf1-434e-8134-\
380101cb296f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.792763478571301*^9, 3.792763480190461*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"17bce07e-2ed3-4050-aed0-a1e7f896d69f"],

Cell[TextData[{
 "Let us now assume that two habitats are available to the population, and \
dispersal happens at rate ",
 StyleBox["m",
  FontSlant->"Italic"],
 ". In the life cycle of the organisms, dispersal happens at the end of every \
discrete generation, after reproduction and survival (the offspring have 100% \
chances of survival). The population of a mutant has the following dynamics:"
}], "Text",
 CellChangeTimes->{{3.791710589507999*^9, 3.79171062966003*^9}, {
  3.791710864137944*^9, 3.791710865365795*^9}, {3.7917109125904007`*^9, 
  3.791710968091538*^9}, {3.7917761905840063`*^9, 3.791776209350381*^9}, {
  3.792760424403995*^9, 3.7927604354175253`*^9}, {3.7927616240157213`*^9, 
  3.792761625254631*^9}},ExpressionUUID->"2c8466ca-81c1-41ba-a526-\
d41f77f86a9c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", 
        RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"xm", ",", " ", "x"}], "]"}], ",", " ", "0"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"xm", ",", " ", "x"}], "]"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["dM", "1"], ",", " ", 
     SubscriptBox["dM", "2"]}], "}"}], " ", "=", 
   RowBox[{"\[CapitalLambda]", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["M", "1"], ",", " ", 
      SubscriptBox["M", "2"]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.791776212680539*^9, 3.791776334621744*^9}, {
  3.792317759342183*^9, 3.792317766500484*^9}, {3.792760460567792*^9, 
  3.792760581733636*^9}, {3.792761598145743*^9, 3.7927616200513163`*^9}, {
  3.792763445452527*^9, 3.7927634683337803`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5d378a3a-e610-499e-b785-4bbd27df7ee9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], " ", 
         SubscriptBox["M", "1"], " ", 
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"xm", ",", "x"}], "]"}]}], "+", 
        RowBox[{"m", " ", 
         SubscriptBox["M", "2"], " ", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"xm", ",", "x"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"m", " ", 
         SubscriptBox["M", "1"], " ", 
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"xm", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], " ", 
         SubscriptBox["M", "2"], " ", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"xm", ",", "x"}], "]"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792760545600094*^9, 3.792760566773662*^9}, {
   3.792763470778234*^9, 3.792763483674218*^9}, 3.792827261040489*^9, 
   3.7928275130557013`*^9},
 CellLabel->
  "Out[3]//MatrixForm=",ExpressionUUID->"258c6831-20db-4271-9a43-\
3e5d30dd6b37"]
}, Open  ]],

Cell[TextData[{
 "where ",
 StyleBox["m",
  FontSlant->"Italic"],
 " is the migration rate between the two patches, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "j"], TraditionalForm]],ExpressionUUID->
  "9139bee1-f4c9-4118-92c7-7d6ed86cb94e"],
 " is the population density and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "j"], TraditionalForm]],ExpressionUUID->
  "94c10696-f475-4a04-b297-812f731af032"],
 " is the per capita growth rate in patch ",
 StyleBox["j.",
  FontSlant->"Italic"],
 " The per capita growth rate in each habitat patch is"
}], "Text",
 CellChangeTimes->{{3.791776338053213*^9, 3.791776420477146*^9}, {
  3.7927605906920652`*^9, 
  3.792760685151306*^9}},ExpressionUUID->"32681117-2426-4037-b3e2-\
63a3bfe14e86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "1"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"1", "-", "d", " ", "+", " ", 
    RowBox[{
     SubscriptBox["W", "1"], "[", 
     RowBox[{"xm", ",", " ", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "2"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"1", "-", "d", " ", "+", " ", 
    RowBox[{
     SubscriptBox["W", "2"], "[", 
     RowBox[{"xm", ",", " ", "x"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7927606924262733`*^9, 3.792760813464469*^9}, {
  3.792761631361877*^9, 3.79276165558317*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"0019ea19-8085-4960-9ea4-4141dee15c1b"],

Cell[TextData[{
 "where ",
 StyleBox["d",
  FontSlant->"Italic"],
 " is the per capita death rate and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}], ")"}], TraditionalForm]],
  ExpressionUUID->"eb58c163-f203-41c2-b813-f59d808e40ad"],
 " is the per capita birth rate of a mutant with trait value ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "m"], TraditionalForm]],ExpressionUUID->
  "0b94a126-c4fc-43ba-be86-09d3ce14aae9"],
 " in a resident population with trait value ",
 StyleBox["x",
  FontSlant->"Italic"],
 ", in patch ",
 StyleBox["j.",
  FontSlant->"Italic"],
 " The birth rate in each habitat is given by:"
}], "Text",
 CellChangeTimes->{
  3.79276069007246*^9, {3.7927607933634853`*^9, 
   3.7927608752795153`*^9}},ExpressionUUID->"40af5ce1-4ae6-417b-9cad-\
bdb00a05b337"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["W", "1"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["e", "1"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "11"], "[", "x", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["e", "2"], "[", "xm", "]"}], 
     RowBox[{
      SubscriptBox["R", "21"], "[", "x", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["W", "2"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["e", "1"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "12"], "[", "x", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["e", "2"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "22"], "[", "x", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791776421752165*^9, 3.791776519500738*^9}, {
  3.7927608805950937`*^9, 3.792760934702324*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"0aea77f7-b487-4744-bd7d-557cb9452c47"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "ij"], TraditionalForm]],ExpressionUUID->
  "927aebcc-ec1e-413f-8eb0-df2c423bb83e"],
 "is the equilibrium concentration of resource ",
 StyleBox["i",
  FontSlant->"Italic"],
 " in patch ",
 StyleBox["j",
  FontSlant->"Italic"],
 ". We assume that the mutants are rare enough that they do not affect the \
equilibrium resource concentrations. The resource concentrations therefore \
follow the dynamics"
}], "Text",
 CellChangeTimes->{{3.791776527532202*^9, 3.7917765722120733`*^9}, {
  3.792761027814459*^9, 3.7927610456886063`*^9}, {3.792763066186242*^9, 
  3.792763082143654*^9}},ExpressionUUID->"2a0c6e71-f369-40e5-92db-\
f5335c916cd3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "11"], "=", " ", 
   RowBox[{"a", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], "[", "x", "]"}], 
        SubscriptBox["N", "1"]}]}], ")"}], 
     SubscriptBox["R", "11"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "21"], "=", " ", 
   RowBox[{
    RowBox[{"h", " ", "a"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "2"], "[", "x", "]"}], 
        SubscriptBox["N", "1"]}]}], ")"}], 
     SubscriptBox["R", "21"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "12"], "=", " ", 
   RowBox[{
    RowBox[{"h", " ", "a"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], "[", "x", "]"}], 
        SubscriptBox["N", "2"]}]}], ")"}], 
     SubscriptBox["R", "12"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "22"], "=", " ", 
   RowBox[{"a", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "2"], "[", "x", "]"}], 
        SubscriptBox["N", "2"]}]}], ")"}], 
     SubscriptBox["R", "22"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7917765739348507`*^9, 3.7917766601484013`*^9}, {
   3.791778411263022*^9, 3.7917784407647343`*^9}, {3.792314185888695*^9, 
   3.792314209925867*^9}, {3.792409501624516*^9, 3.792409516266899*^9}, {
   3.7927610584100113`*^9, 3.792761076512562*^9}, 3.792761121135495*^9, {
   3.792763090984233*^9, 3.7927632028672132`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"f7a77f8f-67e6-4650-89f7-4a2346b19575"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "e6af11f2-d3d5-453b-a299-404081b9c35d"],
 " is the rate of inflow of resources, ",
 StyleBox["b ",
  FontSlant->"Italic"],
 "is the relative rate of outflow and ",
 StyleBox["h",
  FontSlant->"Italic"],
 " is the degree of asymmetry in resource inflow between the habitats. \
Assuming fast resource dynamics relative to population dynamics, the \
equilibrium resource concentrations are:"
}], "Text",
 CellChangeTimes->{{3.792763207341544*^9, 3.792763230953911*^9}, {
  3.792763387472402*^9, 
  3.792763410910084*^9}},ExpressionUUID->"b61f11c5-658d-4ac7-9b93-\
0f606d9f8e17"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Req", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["dR", "11"], "\[Equal]", 
        SubscriptBox["R", "11"]}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "21"], "\[Equal]", 
        SubscriptBox["R", "21"]}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "12"], "\[Equal]", 
        SubscriptBox["R", "12"]}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "22"], "\[Equal]", 
        SubscriptBox["R", "22"]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["R", "11"], ",", " ", 
       SubscriptBox["R", "21"], ",", " ", 
       SubscriptBox["R", "12"], ",", " ", 
       SubscriptBox["R", "22"]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "11"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "11"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "21"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "21"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "12"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "12"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "22"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "22"], "/.", "Req"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7927632327163143`*^9, 3.7927633677195387`*^9}, {
   3.792764694786305*^9, 3.792764729086347*^9}, 3.792827526682859*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"4f0b6352-a739-4a4f-8bc2-a902fec4aca8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["R", "11"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]}]]}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]}]], "+", 
      RowBox[{"b", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], "2"]}]]}], "+", 
      SubscriptBox["N", "1"]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "21"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]], " ", "h"}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]], "+", 
      RowBox[{"b", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]]}], "+", 
      SubscriptBox["N", "1"]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "12"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]}]], " ", "h"}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}], "2"]}]], "+", 
      RowBox[{"b", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], "2"]}]]}], "+", 
      SubscriptBox["N", "2"]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "22"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]]}], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"s", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]], "+", 
      RowBox[{"b", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"s", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]]}], "+", 
      SubscriptBox["N", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.792827526942231*^9, 3.792924669656554*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"6e6c1ac2-d1b6-4e30-b4bf-ba0c0c1c8df8"]
}, Open  ]],

Cell["The attack rates are given by", "Text",
 CellChangeTimes->{{3.791776785997264*^9, 3.791776792323037*^9}, {
   3.7917768535967293`*^9, 3.7917770703561773`*^9}, {3.791777108970784*^9, 
   3.7917771545228987`*^9}, {3.791777204931284*^9, 3.7917772237380047`*^9}, {
   3.792411448000637*^9, 3.792411471831353*^9}, {3.792761088254983*^9, 
   3.792761096089858*^9}, {3.792761129050665*^9, 3.792761153029683*^9}, 
   3.792763404539537*^9},ExpressionUUID->"1b853e43-dca9-4bf0-aeee-\
ce87c894c597"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "1"], "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "+", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "2"], "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "-", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.792761156297627*^9, 3.792761211502667*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"fb95c365-71fa-4093-a425-b3dbc0553bd3"],

Cell["\<\
The invasion fitness of the mutant is the leading eigenvalue of the \
transition matrix\
\>", "Text",
 CellChangeTimes->{{3.7924870446171217`*^9, 3.792487066897064*^9}, {
  3.792761337376606*^9, 
  3.792761339312216*^9}},ExpressionUUID->"c1b27ae4-3c6e-43b9-908a-\
0e4d34172d0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"Eigenvalues", "[", "\[CapitalLambda]", "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792487097741696*^9, 3.7924871362537193`*^9}, {
  3.792750451045586*^9, 3.7927504511364527`*^9}, {3.7927519641299543`*^9, 
  3.792751983178142*^9}, {3.792827537263878*^9, 3.7928275404304733`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"a1ad1492-5b4e-418d-881c-c4fa381884c1"],

Cell["\<\
The fitness gradient is the derivative of the invasion fitness function with \
respect to the mutant trait value, evaluated at the resident trait value,\
\>", "Text",
 CellChangeTimes->{{3.792487274239406*^9, 
  3.792487293784237*^9}},ExpressionUUID->"380a5d60-f097-4eac-9002-\
c4f9256ab385"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grad", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Lambda]", ",", " ", "xm"}], "]"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792487296116774*^9, 3.792487310888296*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"c32bbc21-ec7f-41a4-8dcc-52fdfe3fefe1"],

Cell[TextData[{
 "Evolutionary singularities are values of ",
 StyleBox["x",
  FontSlant->"Italic"],
 " at which the fitness gradient is zero. However, to evaluate the fitness \
gradient we need the equilibrium population densities of the resident, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "1"], TraditionalForm]],ExpressionUUID->
  "a5641858-6cba-4dd9-812f-35aa55afddc0"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "2"], TraditionalForm]],ExpressionUUID->
  "f4c6b7af-2b18-41ce-937f-1b9579f96590"],
 ", which are also functions of ",
 StyleBox["x",
  FontSlant->"Italic"],
 ". We must therefore solve the ecological and the evolutionary dynamics in \
one step,"
}], "Text",
 CellChangeTimes->{{3.792487646331431*^9, 3.7924877728675747`*^9}, {
  3.792487803290901*^9, 
  3.792487817099244*^9}},ExpressionUUID->"09d1db8e-f127-435b-b992-\
613e5a54a8dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dN", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "1"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dN", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "2"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "1"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dM", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "1"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dM", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "2"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "1"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamics", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["dN", "1"], "\[Equal]", " ", 
      SubscriptBox["N", "1"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dN", "2"], "\[Equal]", " ", 
      SubscriptBox["N", "2"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dM", "1"], "\[Equal]", " ", 
      SubscriptBox["M", "1"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dM", "2"], "\[Equal]", " ", 
      SubscriptBox["M", "2"]}], ",", " ", 
     RowBox[{"grad", " ", "\[Equal]", " ", "0"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.792750520147826*^9, 3.792750520473502*^9}, {
  3.792750580185968*^9, 3.792750614679731*^9}, {3.792750893797038*^9, 
  3.792750893950061*^9}, {3.792751177779767*^9, 3.792751244051896*^9}, {
  3.792751277629825*^9, 3.792751279295052*^9}, {3.792751310717473*^9, 
  3.7927514767360373`*^9}, {3.792752020192103*^9, 3.792752030232621*^9}, {
  3.7927636236020727`*^9, 3.7927636237171497`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"5fe5bb3a-b72c-4e45-853e-cc82346df9d0"],

Cell["\<\
The eco-evolutionary dynamics can be solved numerically given some parameter \
values\
\>", "Text",
 CellChangeTimes->{{3.792763635633943*^9, 
  3.792763650335993*^9}},ExpressionUUID->"ef55aabf-1a4b-4774-a545-\
7c31990db4ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "100"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "30"}], ",", " ", 
     RowBox[{"h", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"s", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"m", "\[Rule]", "0.01"}], ",", " ", 
     RowBox[{"d", "\[Rule]", "0.2"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792751568559044*^9, 3.7927516365779123`*^9}, {
   3.79275228862428*^9, 3.792752288647477*^9}, 3.792761468889205*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"8f09c612-7a3e-4150-9429-ba7f2ffb5f4e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dynamics", "/.", "pars"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "1"], ",", " ", "10000"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "2"], ",", " ", "10000"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "1"], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "2"], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7927515422523327`*^9, 3.792751564352084*^9}, {
  3.7927516465647907`*^9, 3.792751688553184*^9}, {3.7927517728498917`*^9, 
  3.792751781875915*^9}, {3.792752300548695*^9, 3.792752302444861*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"e3324da8-1dd8-4c2b-9a10-a4cdee0e476e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["N", "1"], "\[Rule]", "915.7332633177696`"}], ",", 
   RowBox[{
    SubscriptBox["N", "2"], "\[Rule]", "915.7332633177696`"}], ",", 
   RowBox[{
    SubscriptBox["M", "1"], "\[Rule]", "0.`"}], ",", 
   RowBox[{
    SubscriptBox["M", "2"], "\[Rule]", "0.`"}], ",", 
   RowBox[{"x", "\[Rule]", "1.172768615027658`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7927533157681637`*^9, 3.792827555379458*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6c2c952d-8d36-43a0-a13f-aa8b227b9c33"]
}, Open  ]],

Cell[TextData[{
 "Note that in the limit case where ",
 StyleBox["m",
  FontSlant->"Italic"],
 " is zero, this model corresponds to two independent instances of the \
sympatric model previously introduced."
}], "Text",
 CellChangeTimes->{{3.792765562524364*^9, 
  3.79276560739475*^9}},ExpressionUUID->"7425d7c3-5fae-4034-88eb-\
7a7f8440ae38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sexual reproduction", "Section",
 CellChangeTimes->{{3.792419621521846*^9, 3.792419631242015*^9}, {
  3.792484546836072*^9, 
  3.792484549012187*^9}},ExpressionUUID->"47d5bcdb-6be7-474b-99e5-\
ca4db4a9132b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7924852634438143`*^9, 3.7924852654176064`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e45eb4aa-855a-4fb6-9acf-687b8231b2de"],

Cell["\<\
Let us now assume a population with sexual reproduction with a biased sex \
ratio of males and females. The genetics are still haploid with one locus \
that can have an infinity of continuous-valued alleles. We still are in a \
two-patch system. We now assume that the life cycle starts with competition \
for the resource, then goes on with reproduction, survival and finally \
dispersal. The order of events is the same as before, we just changed our \
reference point for the beginning of a new generation.  The number of mutant \
individuals in each patch follows a recursion linear system with the \
following transition matrix:\
\>", "Text",
 CellChangeTimes->{{3.792419634417634*^9, 3.792419639865984*^9}, {
  3.7924197659264402`*^9, 3.792419800966758*^9}, {3.792472003930901*^9, 
  3.792472014562511*^9}, {3.792472139873995*^9, 3.792472236121744*^9}, {
  3.7924738111299267`*^9, 3.792473828530118*^9}, {3.7924739477770844`*^9, 
  3.7924739573616867`*^9}, {3.792474269063888*^9, 3.792474269775899*^9}, {
  3.792474366295354*^9, 3.792474372023637*^9}, {3.792749108968398*^9, 
  3.7927491096419373`*^9}, {3.792751060118412*^9, 
  3.792751088276064*^9}},ExpressionUUID->"4be7d716-5a67-4be4-919f-\
7514a23138f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dmat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"m", ",", " ", 
       RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79294343906686*^9, 3.792943546485403*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"4b19338b-7f35-465f-b4a1-1db43c06c28f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cmat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1", "[", 
        RowBox[{"y", ",", " ", "x"}], "]"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"r2", "[", 
        RowBox[{"y", ",", " ", "x"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.792943860993433*^9, 3.792943870998458*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"5a726d86-1b6c-4bee-9491-97d5be51064d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", 
   RowBox[{"Dmat", " ", ".", " ", "Cmat"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Dmat", " ", "//", " ", "MatrixForm"}], ")"}], " ", ".", " ", 
  RowBox[{"(", 
   RowBox[{"Cmat", " ", "//", " ", "MatrixForm"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.792943566765381*^9, 3.792943628655053*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"3369ffbb-acdd-4c2c-95b9-2aaf311e2741"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"1", "-", "m"}], "m"},
      {"m", 
       RowBox[{"1", "-", "m"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], ".", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"r1", "[", 
        RowBox[{"y", ",", "x"}], "]"}], "0"},
      {"0", 
       RowBox[{"r2", "[", 
        RowBox[{"y", ",", "x"}], "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Output",
 CellChangeTimes->{{3.7929435716652517`*^9, 3.7929436289707603`*^9}, 
   3.7929438750914383`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"fd144ecd-27fd-4345-9653-f5dcfcd2a14a"]
}, Open  ]],

Cell["\<\
where Dmat represents the dispersal step and Cmat represent within-patch \
growth, where competition and sexual selection happens. The invasion fitness \
of the mutant is the leading eigenvalue of the transition matrix,\
\>", "Text",
 CellChangeTimes->{{3.792943778638136*^9, 3.7929438280703173`*^9}, {
  3.792943922781515*^9, 
  3.7929439339018593`*^9}},ExpressionUUID->"8a8ce5e9-40f0-403a-b8db-\
76d2d6556410"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"\[CapitalLambda]", ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.792944517396947*^9, 3.79294452270746*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"cc3feb21-02ce-451b-9646-ec4d3e0b57e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["r1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}], ",", 
     RowBox[{"m", " ", 
      RowBox[{
       SuperscriptBox["r2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", " ", 
      RowBox[{
       SuperscriptBox["r1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "m"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["r2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792944525776623*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"7d178bb8-0b50-410f-88fc-3342cb26ce75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalLambda]", " ", "//", " ", "Eigenvectors"}]], "Input",
 CellChangeTimes->{{3.7929445053638783`*^9, 3.792944510053726*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"6e34851b-1cbf-4476-b009-ea794f56ea51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"r1", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}], "-", 
         RowBox[{"m", " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"4", " ", "m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            SuperscriptBox[
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}],
      ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"r1", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}], "-", 
         RowBox[{"m", " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"4", " ", "m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            SuperscriptBox[
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}],
      ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792944510630973*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"84314801-c657-4ae5-8fdb-c39312298ebf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "//", " ", "Transpose"}], " ", "//", " ", 
  "Eigenvectors"}]], "Input",
 CellChangeTimes->{{3.7929444623786697`*^9, 3.7929444770349073`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"cc5e3d83-aea7-498c-bfdd-026cb4769777"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}], "-", 
         RowBox[{"m", " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"4", " ", "m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            SuperscriptBox[
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}],
      ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}], "-", 
         RowBox[{"m", " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r1", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"4", " ", "m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"r1", "[", 
              RowBox[{"y", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}]}], "+", 
            SuperscriptBox[
             RowBox[{"r2", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "2"], "-", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox[
              RowBox[{"r2", "[", 
               RowBox[{"y", ",", "x"}], "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}],
      ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792944477588135*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"f8fae230-a8ad-4c05-8125-6033d9e324ce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"leigenvector", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"M", "/.", "params"}], " ", "//", " ", "Transpose"}], " ", "//",
       " ", "Eigenvectors"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
    "First"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.785476698380993*^9, 3.785476701454006*^9}, {
  3.7854767828699512`*^9, 3.785476816314478*^9}, {3.78547691197243*^9, 
  3.785476949043479*^9}, {3.785476984324922*^9, 
  3.785477001517894*^9}},ExpressionUUID->"5148ad25-33cf-4cad-8e38-\
8affd50d1b5b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]", "=", 
  RowBox[{
   RowBox[{"Eigenvalues", "[", "\[CapitalLambda]", "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.79294383485135*^9, 3.792943938193932*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"33ee32a7-c1b3-4df9-913a-69cb30c78424"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"r1", "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{"r1", "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{"r2", "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{"r2", "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"r2", "[", 
          RowBox[{"y", ",", "x"}], "]"}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"2", " ", "m", " ", 
          RowBox[{"r1", "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{"r2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.792943938431842*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"0c9220b4-3dbe-490c-9ca2-67df5663a036"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"\[Lambda]", ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "x"}]}]], "Input",
 CellChangeTimes->{{3.792943943181999*^9, 3.7929439552697763`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"1679b0f8-2181-47e0-8240-28f1934491e4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["r1", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox["r1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["r2", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox["r2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"r1", "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"r1", "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "-", 
          RowBox[{"r2", "[", 
           RowBox[{"x", ",", "x"}], "]"}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"r2", "[", 
            RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            SuperscriptBox["r1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{
            SuperscriptBox["r1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["r2", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "x"}], "]"}], "+", 
          RowBox[{"m", " ", 
           RowBox[{
            SuperscriptBox["r2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r2", "[", 
            RowBox[{"x", ",", "x"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["r1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "-", 
          RowBox[{"2", " ", "m", " ", 
           RowBox[{"r2", "[", 
            RowBox[{"x", ",", "x"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["r1", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"r1", "[", 
            RowBox[{"x", ",", "x"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["r2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "-", 
          RowBox[{"2", " ", "m", " ", 
           RowBox[{"r1", "[", 
            RowBox[{"x", ",", "x"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["r2", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"r1", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}], "-", 
            RowBox[{"r2", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"r2", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}], "2"], "-", 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"r1", "[", 
              RowBox[{"x", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}], "-", 
            RowBox[{"2", " ", "m", " ", 
             RowBox[{"r1", "[", 
              RowBox[{"x", ",", "x"}], "]"}], " ", 
             RowBox[{"r2", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}]}]]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.792943951209508*^9, 3.792943955702434*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"0c370713-c2d5-4dfc-bb08-543f3699088b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Eigenvectors", "[", "\[CapitalLambda]", "]"}]], "Input",
 CellChangeTimes->{{3.792944234964652*^9, 
  3.792944289920246*^9}},ExpressionUUID->"4950832e-55e9-456b-9eac-\
5a2fd66a9a4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", 
        RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}], " ", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"y", ",", "x"}], "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"y", ",", " ", "x"}], "]"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["dM", "1"], ",", " ", 
     SubscriptBox["dM", "2"]}], "}"}], " ", "=", 
   RowBox[{"\[CapitalLambda]", ".", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["M", "1"], ",", " ", 
      SubscriptBox["M", "2"]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7927491325372543`*^9, 3.792749271482624*^9}, {
   3.792750319538535*^9, 3.792750352508757*^9}, {3.79275100597121*^9, 
   3.792751018683825*^9}, {3.792751091854699*^9, 3.792751092902446*^9}, {
   3.792751994191248*^9, 3.792751999407835*^9}, 3.79282787019687*^9, 
   3.792831697096277*^9, {3.793101164706406*^9, 3.793101166936598*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"99a62d76-f3c6-4cab-b946-59630548c1eb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], " ", 
         SubscriptBox["M", "1"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "d", "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "x"}], "+", "y"}], ")"}], "2"]}], " ", 
                "\[Alpha]"}]]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["W", "1"], "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"m", " ", 
         SubscriptBox["M", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "d", "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "x"}], "+", "y"}], ")"}], "2"]}], " ", 
                "\[Alpha]"}]]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["W", "2"], "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"m", " ", 
         SubscriptBox["M", "1"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "d", "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "x"}], "+", "y"}], ")"}], "2"]}], " ", 
                "\[Alpha]"}]]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["W", "1"], "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], " ", 
         SubscriptBox["M", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "d", "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "x"}], "+", "y"}], ")"}], "2"]}], " ", 
                "\[Alpha]"}]]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["W", "2"], "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792750332220854*^9, 3.792750353520321*^9}, 
   3.792750393617579*^9, 3.79275110367552*^9, 3.7927518599446583`*^9, 
   3.792752047759142*^9, 3.79275328527709*^9, 3.792827569336543*^9, {
   3.792827844575911*^9, 3.792827871881316*^9}, {3.792831690757936*^9, 
   3.792831700371797*^9}, 3.7928340806505117`*^9, 3.79292469053481*^9, 
   3.792924941860108*^9, 3.7929251635490503`*^9, 3.79292551644418*^9, 
   3.792943371265712*^9, 3.793100991536623*^9, 3.793101168581118*^9, 
   3.7931020583691587`*^9, 3.79310208896588*^9},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"db67ac8d-0c63-4777-82bf-\
bdb31689b1bc"]
}, Open  ]],

Cell[TextData[{
 "where ",
 StyleBox["m",
  FontSlant->"Italic"],
 " is the migration rate between the patches and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "1"], TraditionalForm]],ExpressionUUID->
  "3730e7e8-331e-43af-88f4-7d7f405069da"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "2"], TraditionalForm]],ExpressionUUID->
  "6723cd65-1036-476f-a411-d4725d741e8c"],
 " are the local per capita growth rates for each patch. Those are given by"
}], "Text",
 CellChangeTimes->{{3.792749333621084*^9, 
  3.792749383258625*^9}},ExpressionUUID->"2f2be72c-2389-4f74-b301-\
03f159c3881d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "1"], "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox["W", "1"], "[", 
      RowBox[{"y", ",", " ", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       FractionBox[
        RowBox[{"A", "[", 
         RowBox[{"y", ",", " ", "x"}], "]"}], 
        RowBox[{"A", "[", 
         RowBox[{"x", ",", " ", "x"}], "]"}]]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "2"], "[", 
    RowBox[{"y_", ",", " ", "x_"}], "]"}], ":=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox["W", "2"], "[", 
      RowBox[{"y", ",", " ", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       FractionBox[
        RowBox[{"A", "[", 
         RowBox[{"y", ",", " ", "x"}], "]"}], 
        RowBox[{"A", "[", 
         RowBox[{"x", ",", " ", "x"}], "]"}]]}], ")"}]}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.7927493871104717`*^9, 3.7927494844653273`*^9}, {
  3.792751109349636*^9, 3.792751127155527*^9}, {3.792752039661243*^9, 
  3.792752040884294*^9}, {3.7931020653335247`*^9, 3.7931020821130323`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"87eb45e7-ac6f-4a3a-8909-697388a7e317"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["r", "1"], "[", 
  RowBox[{"x", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.7929267071820374`*^9, 3.792926713263884*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"67d19bd6-cca0-4d8d-90c2-de3b1f758e17"],

Cell[BoxData[
 RowBox[{"1", "-", "d", "+", 
  RowBox[{
   SubscriptBox["W", "1"], "[", 
   RowBox[{"x", ",", "x"}], "]"}]}]], "Output",
 CellChangeTimes->{3.792926713745364*^9, 3.793102092667139*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"83bc19c9-f58f-464c-87ea-0cde9c1302f0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y", "-", "x"}], ")"}], "2"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.793100859718254*^9, 3.793100908311585*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"28559623-e018-4034-8a57-e74481db1ed6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "//", "Eigenvalues"}], "//", "Last"}], ",", 
     "y"}], "]"}], "/.", 
   RowBox[{"y", "\[Rule]", "x"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.793101002139483*^9, 3.7931010160996113`*^9}, {
  3.793101150408787*^9, 3.793101152668779*^9}, {3.793102106797686*^9, 
  3.793102123661188*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"8ac0f573-a21f-4354-b89c-b46d9297817a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["W", "1"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["W", "1"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["W", "2"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["W", "2"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           RowBox[{
            SubscriptBox["W", "1"], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "m"}], "+", 
             SuperscriptBox["m", "2"]}], ")"}], " ", 
           RowBox[{
            SubscriptBox["W", "2"], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "1"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           SuperscriptBox["m", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "m"}], "+", 
             SuperscriptBox["m", "2"]}], ")"}], " ", 
           RowBox[{
            SubscriptBox["W", "1"], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           RowBox[{
            SubscriptBox["W", "2"], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "2"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      SqrtBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
         SuperscriptBox["m", "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["W", "1"], "[", 
           RowBox[{"x", ",", "x"}], "]"}], "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{
          SubscriptBox["W", "2"], "[", 
          RowBox[{"x", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["W", "2"], "[", 
           RowBox[{"x", ",", "x"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{
          SubscriptBox["W", "1"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
            SuperscriptBox["m", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}], "+", 
              SuperscriptBox["m", "2"]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["W", "2"], "[", 
             RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}]}]], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.793101004307899*^9, 3.793101016481701*^9}, 
   3.793101136471128*^9, {3.793102100930525*^9, 3.793102124249854*^9}},
 CellLabel->"Out[97]=",ExpressionUUID->"29b0f5a1-b668-4314-97ae-ddaa7857ccc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], ",", "y", ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "x"}]}]}], "Input",
 CellChangeTimes->{{3.7929255318172827`*^9, 3.792925555599811*^9}, {
  3.7929256371855917`*^9, 3.792925639223727*^9}, {3.7929257305315638`*^9, 
  3.792925730936507*^9}, {3.792925939554079*^9, 3.792925959353331*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"045c90aa-a5bd-4432-a579-e547468d0aec"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   SubscriptBox["W", "1"], 
   TagBox[
    RowBox[{"(", 
     RowBox[{"1", ",", "0"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"x", ",", "x"}], "]"}]], "Output",
 CellChangeTimes->{{3.7929255563977203`*^9, 3.792925575656501*^9}, 
   3.7929256402913723`*^9, 3.792925731846179*^9, {3.792925944595344*^9, 
   3.792925960318719*^9}, 3.793100852050041*^9, 3.793100911680958*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"84ba72bc-27e3-483c-95f5-4efc76533b32"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[Alpha]"}], " ", 
   RowBox[{
    SubscriptBox["W", "1"], "[", 
    RowBox[{"x", ",", "x"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    SubscriptBox["W", "1"], 
    TagBox[
     RowBox[{"(", 
      RowBox[{"2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "x"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7929255563977203`*^9, 3.792925575656501*^9}, 
   3.7929256402913723`*^9, 3.792925731846179*^9, {3.792925944595344*^9, 
   3.792925960318719*^9}, 3.793100852050041*^9, 3.7931009116823883`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"41a29406-736c-4f02-95f8-c5e767faa42f"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.793104462551958*^9},ExpressionUUID->"90ab3545-a1ee-4e4b-b8cd-\
ec3b2fc83cca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quit", "[", "]"}], ";"}], " "}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"ed3e1472-807c-4372-90ac-6cd9e1c245ef"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["m", "11"], "[", "x", "]"}], ",", 
       RowBox[{
        SubscriptBox["m", "12"], "[", "x", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["m", "21"], "[", "x", "]"}], ",", 
       RowBox[{
        SubscriptBox["m", "22"], "[", "x", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "M", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[Lambda]", ",", "x"}], "]"}], ",", "x"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7931681708750887`*^9, 3.7931681766173697`*^9}, {
  3.793172711183592*^9, 3.7931728096193123`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"5154c2a0-871d-4ba2-9b78-48b6da5a1a4a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{
           SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "11"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{
           SubscriptBox["m", "22"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "11"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{
           SubscriptBox["m", "21"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "12"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{
           SubscriptBox["m", "12"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "21"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{
           SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "22"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{
           SubscriptBox["m", "22"], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["m", "22"], "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            SubscriptBox["m", "11"], "[", "x", "]"}], "2"], "+", 
          RowBox[{"4", " ", 
           RowBox[{
            SubscriptBox["m", "12"], "[", "x", "]"}], " ", 
           RowBox[{
            SubscriptBox["m", "21"], "[", "x", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{
            SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
           RowBox[{
            SubscriptBox["m", "22"], "[", "x", "]"}]}], "+", 
          SuperscriptBox[
           RowBox[{
            SubscriptBox["m", "22"], "[", "x", "]"}], "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["m", "11"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["m", "22"], "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           SubscriptBox["m", "11"], "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
       RowBox[{"8", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "12"], "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "21"], "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "11"], "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "22"], "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox[
           SubscriptBox["m", "22"], "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "11"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["m", "22"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "11"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SubscriptBox["m", "21"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "12"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SubscriptBox["m", "12"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "21"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "22"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["m", "22"], "[", "x", "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["m", "22"], "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SubscriptBox["m", "11"], "[", "x", "]"}], "2"], "+", 
         RowBox[{"4", " ", 
          RowBox[{
           SubscriptBox["m", "12"], "[", "x", "]"}], " ", 
          RowBox[{
           SubscriptBox["m", "21"], "[", "x", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{
           SubscriptBox["m", "11"], "[", "x", "]"}], " ", 
          RowBox[{
           SubscriptBox["m", "22"], "[", "x", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["m", "22"], "[", "x", "]"}], "2"]}]]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.7931727725109797`*^9, 3.793172810086659*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"2ac75176-c3cb-4d13-86cd-6c13932a7a04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvectors", "[", "\[CapitalLambda]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "//", " ", "Transpose"}], "//", 
  "Eigenvectors"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", "\[CapitalLambda]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "[", "\[CapitalLambda]", "]"}]}], "Input",
 CellChangeTimes->{{3.79312494059991*^9, 3.793125024770794*^9}, {
  3.79312522643497*^9, 3.793125233337781*^9}, {3.7931254299095907`*^9, 
  3.793125434113039*^9}, {3.79312553575124*^9, 3.793125544525999*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"9bfdda38-ec28-4a79-b2b8-670d82a0d9f7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.793124977606119*^9, 3.793125025219884*^9}, 
   3.793125233747819*^9, 3.793125434762663*^9, 3.793125545112554*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"113775c4-7bf5-41db-895e-2cb76b0ca38a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "b"}]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "b"}]]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.793124977606119*^9, 3.793125025219884*^9}, 
   3.793125233747819*^9, 3.793125434762663*^9, 3.7931255451323147`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"8ef15fe5-31f6-4fc3-ba34-2bb6fd371376"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", "d", "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", "d", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.793124977606119*^9, 3.793125025219884*^9}, 
   3.793125233747819*^9, 3.793125434762663*^9, 3.7931255451362057`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"ccb76462-bef3-4c43-82e7-b0ebb5dc98eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "b"}], " ", "c"}], "+", 
  RowBox[{"a", " ", "d"}]}]], "Output",
 CellChangeTimes->{{3.793124977606119*^9, 3.793125025219884*^9}, 
   3.793125233747819*^9, 3.793125434762663*^9, 3.7931255451380453`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"ae396e80-df1f-479e-9f31-2db07e665a8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", 
        RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"y", ",", "x"}], "]"}], ",", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"y", ",", "x"}], "]"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]", "/.", 
       RowBox[{"y", "\[Rule]", "x"}]}], "//", "Transpose"}], "//", 
     "Eigenvectors"}], "//", "Last"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"u", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "/.", 
      RowBox[{"y", "\[Rule]", "x"}]}], "//", "Eigenvectors"}], "//", "Last"}],
    "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]", "//", "Eigenvalues"}], "//", "Last"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]", " ", "/.", 
  RowBox[{"y", "\[Rule]", "x"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.793106670776506*^9, 3.79310672276045*^9}, {
  3.79310676488839*^9, 3.793106843110684*^9}, {3.793106877000746*^9, 
  3.7931071795064783`*^9}, {3.793107210348558*^9, 3.793107250069418*^9}, {
  3.793108062046801*^9, 3.793108065537837*^9}, {3.793125168268957*^9, 
  3.793125178615155*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"6c593b33-ad94-4043-a8d3-b94a9e1a460f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}], " ", 
      RowBox[{
       SubscriptBox["r", "1"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "-", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}], "+", 
          SuperscriptBox["m", "2"]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"x", ",", "x"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}]}]]}], 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.7931077977522917`*^9, 3.7931080664220457`*^9, 
  3.793125179255397*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"aceb1620-a6aa-42b9-acb0-b52be1b3f203"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}], " ", 
      RowBox[{
       SubscriptBox["r", "1"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "-", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}], "+", 
          SuperscriptBox["m", "2"]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"x", ",", "x"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}]}]]}], 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.7931077977522917`*^9, 3.7931080664220457`*^9, 
  3.793125179283104*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"94343916-d45c-456b-b093-dba5b20d2fb8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "m"}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "+", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], ")"}], "2"]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7931077977522917`*^9, 3.7931080664220457`*^9, 
  3.793125179317504*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"97e67a3c-33aa-4894-98e7-3e8cd6b495ce"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "m"}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"x", ",", "x"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"x", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"x", ",", "x"}], "]"}], "+", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"x", ",", "x"}], "]"}]}], ")"}], "2"]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7931077977522917`*^9, 3.7931080664220457`*^9, 
  3.793125179319536*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"4905f7a3-b9fe-416c-8d14-056bfb18a50d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"m", ",", " ", 
        RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], ",", "0"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "}"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "//", "Eigenvalues"}], "//", "Last"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Lambda]", ",", "x"}], "]"}], ",", "y"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7931153080999327`*^9, 3.793115356192374*^9}, {
  3.7931153915954742`*^9, 3.793115454092873*^9}, {3.793118043960794*^9, 
  3.7931180918294373`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"9a649b26-581f-47b9-a300-9eeecab9c3a2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["r", "2"], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["r", "1"], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["r", "1"], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["r", "2"], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", "1"], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
              RowBox[{
               SubscriptBox["r", "2"], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                SubscriptBox["r", "1"], 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
              RowBox[{
               SuperscriptBox[
                SubscriptBox["r", "2"], 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], 
             ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["r", "2"], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["r", "1"], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}]}], ")"}], " ", 
            RowBox[{
             SubscriptBox["r", "1"], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
            RowBox[{
             SuperscriptBox[
              SubscriptBox["r", "2"], 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["r", "1"], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
              RowBox[{
               SubscriptBox["r", "2"], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                SubscriptBox["r", "1"], 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
              RowBox[{
               SuperscriptBox[
                SubscriptBox["r", "2"], 
                TagBox[
                 RowBox[{"(", 
                  RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
                 Derivative],
                MultilineFunction->None], "[", 
               RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], 
             ")"}]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "m"}]}], ")"}], " ", 
             RowBox[{
              SubscriptBox["r", "1"], "[", 
              RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
             RowBox[{
              SubscriptBox["r", "2"], "[", 
              RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["r", "1"], "[", 
                 RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
                RowBox[{
                 SubscriptBox["r", "2"], "[", 
                 RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], 
               ")"}], "2"]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "1"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "2"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "2"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "1"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "1"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "2"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "1"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "2"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "1"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "2"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}]}], 
       "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "1"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["r", "2"], 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "1"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "2"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "m"}]}], ")"}], " ", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["r", "1"], "[", 
              RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}], "+", 
             RowBox[{
              SubscriptBox["r", "2"], "[", 
              RowBox[{"xm", ",", "x", ",", "ym", ",", "y"}], "]"}]}], ")"}], 
           "2"]}]}]]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.793115357113063*^9, {3.793115429576215*^9, 3.793115454858263*^9}, {
   3.7931180588114147`*^9, 3.793118092478362*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"4c3ff84c-2030-4a81-97fe-89ad3a0916ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "//", 
  "Eigenvectors"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "//", "Eigenvalues"}]}], "Input",\

 CellChangeTimes->{{3.793107696602507*^9, 3.793107726169423*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"dc2375cd-f080-42ab-a143-e91f964274d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "a"}], "+", "d", "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"4", " ", "b", " ", "c"}], "-", 
          RowBox[{"2", " ", "a", " ", "d"}], "+", 
          SuperscriptBox["d", "2"]}]]}], 
       RowBox[{"2", " ", "c"}]]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.793107709993802*^9, 3.7931077264471827`*^9}},
 CellLabel->
  "Out[101]=",ExpressionUUID->"4c4081d3-2466-45bb-84c1-d956206a341e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", "d", "-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", "d", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"4", " ", "b", " ", "c"}], "-", 
        RowBox[{"2", " ", "a", " ", "d"}], "+", 
        SuperscriptBox["d", "2"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.793107709993802*^9, 3.7931077264508467`*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"8325a858-1568-4eda-89dd-c8286317dce8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "1"], "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"a", "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["r", "2"], "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"a", "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"v", ".", "\[CapitalLambda]"}], "-", " ", 
    RowBox[{"\[Lambda]", " ", "v"}]}], "\[Equal]", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.793107379692361*^9, 3.793107640274478*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"23f6822f-3561-4904-9a4b-dd99a745bbcb"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.793107593534718*^9, 3.793107644478153*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"8d696b14-483d-4b48-b9b6-642ed7673911"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.793107427787568*^9, 
  3.793107429033537*^9}},ExpressionUUID->"b509f4f0-268c-4a94-b0f4-\
e55ebb540872"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}], " ", 
      RowBox[{
       SubscriptBox["r", "1"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "-", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}], "+", 
          SuperscriptBox["m", "2"]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"x", ",", "x"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}]}]]}], 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7931071800157137`*^9, {3.7931072277305117`*^9, 3.793107250542609*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"65c2daa2-53b7-4991-9105-85686e4aefc9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}], " ", 
      RowBox[{
       SubscriptBox["r", "1"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "-", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}], "+", 
          SuperscriptBox["m", "2"]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"x", ",", "x"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"x", ",", "x"}], "]"}], "2"]}]}]]}], 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7931071800157137`*^9, {3.7931072277305117`*^9, 3.79310725057508*^9}},
 CellLabel->"Out[85]=",ExpressionUUID->"b5c843ff-2e60-4b80-9f16-86b5c4ad8028"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "m"}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}], " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "+", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], ")"}], "2"]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.7931071800157137`*^9, {3.7931072277305117`*^9, 3.7931072505799*^9}},
 CellLabel->"Out[86]=",ExpressionUUID->"96e9b297-5d8a-4d70-908c-1d722aa970e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["v", "1"], ",", 
       SubscriptBox["v", "2"]}], "}"}], ".", 
     RowBox[{"(", " ", 
      RowBox[{"\[CapitalLambda]", "/.", 
       RowBox[{"y", "\[Rule]", "x"}]}], ")"}]}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["v", "1"], ",", 
      SubscriptBox["v", "2"]}], "}"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["v", "1"], ",", 
     SubscriptBox["v", "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.793104143372497*^9, 3.7931041437451677`*^9}, {
  3.793106159900996*^9, 3.793106172294849*^9}, {3.793106208168911*^9, 
  3.7931062327893333`*^9}, {3.79310629897649*^9, 3.7931063579504147`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"25b08a94-b4fb-40d7-a459-6b3c432a96b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["v", "1"], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["v", "2"], "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7931062133034277`*^9, 3.793106233567704*^9}, 
   3.793106314154236*^9, {3.793106344199655*^9, 3.7931063585468807`*^9}},
 CellLabel->
  "Out[105]=",ExpressionUUID->"411585ef-9654-4198-b66f-ed67e1206b09"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.793106205095496*^9, 
  3.7931062050998507`*^9}},ExpressionUUID->"5ac7bf77-cba1-4b0f-b8de-\
9fe9756b9a3a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"y", ",", "x"}], "]"}], ",", "y"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.792926268961019*^9, {3.792926686019144*^9, 3.792926688280775*^9}, {
   3.79310080715303*^9, 3.79310080809225*^9}, {3.79310412890451*^9, 
   3.7931041514747047`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"36541878-1120-4828-90b1-c517e33a1191"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "x"}], "+", "y"}], ")"}], "2"]}], " ", "\[Alpha]"}]], 
  " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "x"}], "+", "y"}], ")"}], " ", "\[Alpha]"}]], "Output",
 CellChangeTimes->{
  3.792926688629819*^9, {3.793104136820763*^9, 3.793104152452662*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"76ebdd22-163c-4078-b863-cb86dc30cc35"]
}, Open  ]],

Cell[TextData[{
 "where ",
 StyleBox["d",
  FontSlant->"Italic"],
 " is the per capita death rate, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}], ")"}], TraditionalForm]],
  ExpressionUUID->"5cf72bcf-a54e-4034-a0d4-1d519dccd394"],
 " is the competitive ability of and individual with trait value ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "m"], TraditionalForm]],ExpressionUUID->
  "7b45a145-72e2-48ab-b5a6-aea9a2391069"],
 " in a resident population ",
 StyleBox["x, ",
  FontSlant->"Italic"],
 "and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}], ")"}], TraditionalForm]],
  ExpressionUUID->"cfca8ec2-e46c-4302-a101-684b01598af2"],
 " is the attractiveness of a male with trait value ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "m"], " "}], TraditionalForm]],ExpressionUUID->
  "fe2cbca3-6d44-4074-90dd-c29533c027dd"],
 "to a female with trait value ",
 StyleBox["x",
  FontSlant->"Italic"],
 ". Here we assume that individuals produce offspring based on their ability \
to compete for the resource in their local patch ",
 StyleBox["j, ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "j"], TraditionalForm]],ExpressionUUID->
  "ba7200d5-771e-469a-af94-c90b82750a71"],
 ". We assume that the mutants are sufficiently rare that they will mate only \
with resident types. Because we assume a haploid one-locus system, half of \
the offspring of the mutants will be mutants. Female mutants will produce ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}], ")"}], TraditionalForm]],
  ExpressionUUID->"013cba29-1074-4499-8d96-93eacd9ae805"],
 " offspring. Male mutants who successfully mate will mate with resident \
females who will contribute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{"x", ",", " ", "x"}], ")"}], TraditionalForm]],ExpressionUUID->
  "669d14ea-f5af-49fd-b77b-a40c1cb8d34e"],
 " offspring to the population. However, the mating success of the males \
depends on their competitive abilities, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}], ")"}], TraditionalForm]],
  ExpressionUUID->"17f2aae9-e1e5-4cc3-a88d-420d837ec5e0"],
 ", and on their attractiveness to the resident females, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}]}], TraditionalForm]],
  ExpressionUUID->"1309ada5-8b82-4a33-a173-0e76ea9d081e"],
 StyleBox[")",
  FontSlant->"Italic"],
 ", relative to the mating success of resident males, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["W", "j"], "(", 
     RowBox[{"x", ",", " ", "x"}], ")"}], " ", 
    RowBox[{"A", "(", 
     RowBox[{"x", ",", " ", "x"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "60bae2cf-f9d1-4778-9dfe-6d34b96d212c"],
 ". Note that the competitive ability of the resident, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "j"], "(", 
    RowBox[{"x", ",", " ", "x"}], ")"}], TraditionalForm]],ExpressionUUID->
  "deaf2fac-e358-4490-a8d4-29ac3cffbd2b"],
 ", cancels out from the equation."
}], "Text",
 CellChangeTimes->{{3.792749497658781*^9, 3.79274960274518*^9}, {
  3.792749703654895*^9, 3.79274992198123*^9}, {3.792749971136052*^9, 
  3.792750026943803*^9}, {3.792750073758038*^9, 
  3.792750106071546*^9}},ExpressionUUID->"c7455f3f-a1c5-42f5-9fba-\
b0042b219a95"],

Cell["The attractiveness function is", "Text",
 CellChangeTimes->{{3.7924760871331253`*^9, 3.7924761016975803`*^9}, {
  3.792484416564805*^9, 
  3.792484417708849*^9}},ExpressionUUID->"42f13714-ba03-436d-8dbc-\
f1bf2499c9f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     SuperscriptBox["\[Alpha]", "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xm", "-", "x"}], ")"}], "2"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792476103673264*^9, 3.792476112497459*^9}, {
   3.792476210624984*^9, 3.792476260704907*^9}, 3.7924763263449793`*^9, {
   3.7924763567208548`*^9, 3.792476364704423*^9}, {3.792484431301444*^9, 
   3.792484443773243*^9}, {3.792833963224531*^9, 3.792834015346961*^9}, {
   3.792925082995023*^9, 3.792925143512273*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"28e242f4-ea87-43f3-9d69-a72604988815"],

Cell[TextData[{
 "The reproductive success ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", 
    RowBox[{
     SubscriptBox["x", "m"], ",", " ", "x"}]}], TraditionalForm]],
  ExpressionUUID->"4109ce1c-d8c6-4fd6-9205-4b167be78781"],
 StyleBox[") ",
  FontSlant->"Italic"],
 "is the result of competition for the resources in the local patch, and \
although it translates differently into number of offspring for males and \
females, its calculation is the same in both sexes."
}], "Text",
 CellChangeTimes->{{3.7924845668837357`*^9, 3.792484635620274*^9}, {
   3.792484714716229*^9, 3.792484743515336*^9}, 3.792484812924446*^9, {
   3.7927501798398733`*^9, 
   3.792750180141733*^9}},ExpressionUUID->"7867d24b-4bea-4aad-bdc7-\
9d029e748f76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["W", "1"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["e", "1"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "11"], "[", "x", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["e", "2"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "21"], "[", "x", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["W", "2"], "[", 
    RowBox[{"xm_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["e", "1"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "12"], "[", "x", "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["e", "2"], "[", "xm", "]"}], " ", 
     RowBox[{
      SubscriptBox["R", "22"], "[", "x", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792484816021921*^9, 3.792484821003512*^9}, {
  3.7924849357143297`*^9, 3.792485007539872*^9}, {3.792751818104187*^9, 
  3.792751820041327*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"7c2a5d30-3da5-482d-b49b-fa7497bc8052"],

Cell["\<\
The equilibrium resource concentrations are calculated assuming fast resource \
dynamics relative to the population dynamics. Also, we assume that the \
mutants are sufficiently rare that only the resident affects the resource \
dynamics, i.e.\
\>", "Text",
 CellChangeTimes->{{3.792485136945063*^9, 3.792485178217679*^9}, {
   3.792750200178851*^9, 3.7927502227916927`*^9}, 3.792764602836426*^9, {
   3.792764644578792*^9, 
   3.792764645707115*^9}},ExpressionUUID->"2dd54106-a119-4edf-8276-\
a1e8fdb237f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["r", "1"], "[", 
  RowBox[{"x", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.792926730332752*^9, 3.792926733814374*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"217a4f24-c622-465d-b5f6-4e76c18b19d7"],

Cell[BoxData[
 RowBox[{"1", "-", "d", "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["e", "1"], "[", "x", "]"}], " ", 
   RowBox[{
    SubscriptBox["R", "11"], "[", "x", "]"}]}], "+", 
  RowBox[{
   RowBox[{
    SubscriptBox["e", "2"], "[", "x", "]"}], " ", 
   RowBox[{
    SubscriptBox["R", "21"], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.792926734261429*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"a62a2e26-dd58-41e4-8f06-0fb769b5293b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "11"], "=", " ", 
   RowBox[{"a", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], "[", "x", "]"}], 
        SubscriptBox["N", "1"]}]}], ")"}], 
     SubscriptBox["R", "11"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "21"], "=", " ", 
   RowBox[{
    RowBox[{"h", " ", "a"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "2"], "[", "x", "]"}], 
        SubscriptBox["N", "1"]}]}], ")"}], 
     SubscriptBox["R", "21"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "12"], "=", " ", 
   RowBox[{
    RowBox[{"h", " ", "a"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "1"], "[", "x", "]"}], 
        SubscriptBox["N", "2"]}]}], ")"}], 
     SubscriptBox["R", "12"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dR", "22"], "=", " ", 
   RowBox[{"a", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", " ", "+", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["e", "2"], "[", "x", "]"}], 
        SubscriptBox["N", "2"]}]}], ")"}], 
     SubscriptBox["R", "22"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792764617111598*^9, 3.7927646410026073`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"59250d04-f14e-4c5f-af9a-edeba6090cca"],

Cell["\<\
Assuming fast resource dynamics relative to the population dynamics, the \
equilibrium resource concentrations are\
\>", "Text",
 CellChangeTimes->{{3.792764649517796*^9, 
  3.792764670439633*^9}},ExpressionUUID->"83c16ba1-20d1-4410-9ea9-\
123952a6f4c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Req", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["dR", "11"], "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "21"], "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "12"], "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        SubscriptBox["dR", "22"], "\[Equal]", "0"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["R", "11"], ",", " ", 
       SubscriptBox["R", "21"], ",", " ", 
       SubscriptBox["R", "12"], ",", " ", 
       SubscriptBox["R", "22"]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "11"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "11"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "21"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "21"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "12"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "12"], "/.", "Req"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["R", "22"], "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["R", "22"], "/.", "Req"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.79248519823457*^9, 3.792485229826453*^9}, {
   3.7927646775953093`*^9, 3.792764683923683*^9}, 3.792764743839788*^9, 
   3.792827903029353*^9, {3.792924797392544*^9, 3.792924804849731*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b1ede9d4-62d7-43f3-b98a-66a67b9370d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["R", "11"], "\[Rule]", 
    FractionBox["a", 
     RowBox[{"b", "+", 
      RowBox[{
       SubscriptBox["N", "1"], " ", 
       RowBox[{
        SubscriptBox["e", "1"], "[", "x", "]"}]}]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "21"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", "h"}], 
     RowBox[{"b", "+", 
      RowBox[{
       SubscriptBox["N", "1"], " ", 
       RowBox[{
        SubscriptBox["e", "2"], "[", "x", "]"}]}]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "12"], "\[Rule]", 
    FractionBox[
     RowBox[{"a", " ", "h"}], 
     RowBox[{"b", "+", 
      RowBox[{
       SubscriptBox["N", "2"], " ", 
       RowBox[{
        SubscriptBox["e", "1"], "[", "x", "]"}]}]}]]}], ",", 
   RowBox[{
    SubscriptBox["R", "22"], "\[Rule]", 
    FractionBox["a", 
     RowBox[{"b", "+", 
      RowBox[{
       SubscriptBox["N", "2"], " ", 
       RowBox[{
        SubscriptBox["e", "2"], "[", "x", "]"}]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.79282790330564*^9, 3.792831711348977*^9, 
  3.7928341189045897`*^9, 3.792924747259325*^9, 3.792924805514245*^9, 
  3.792924962621791*^9, 3.79292518294405*^9, 3.792926740134923*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"23888485-c382-4df3-97e9-dff7de97ab64"]
}, Open  ]],

Cell["The attack rates are given by", "Text",
 CellChangeTimes->{{3.792485269360991*^9, 3.7924852778329268`*^9}, {
  3.792750229898847*^9, 
  3.792750230763864*^9}},ExpressionUUID->"e59fa965-b1a7-4aed-9ab1-\
eb6f1676a3ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "1"], "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "+", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["e", "2"], "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "s"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", " ", "-", " ", "1"}], ")"}], "2"]}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"f2a4192b-65d5-4679-81af-b9c08c82f2ff"],

Cell["\<\
The invasion fitness of the mutant is therefore the leading eigenvalue of the \
transition matrix\
\>", "Text",
 CellChangeTimes->{{3.7924870446171217`*^9, 
  3.792487066897064*^9}},ExpressionUUID->"0933e283-68bf-438e-9daf-\
c7c679016108"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["r", "1"], "[", 
  RowBox[{"x", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.792926748837823*^9, 3.792926754333254*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"1dcf177e-680e-403c-b69d-e1399aea6e42"],

Cell[BoxData[
 RowBox[{"1", "-", "d", "+", 
  FractionBox[
   RowBox[{"a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "s"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]], " ", "h"}], 
   RowBox[{"b", "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "s"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"]}]], " ", 
     SubscriptBox["N", "1"]}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "s"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], "2"]}]]}], 
   RowBox[{"b", "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "s"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], "2"]}]], " ", 
     SubscriptBox["N", "1"]}]}]]}]], "Output",
 CellChangeTimes->{3.792926762774501*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"d1526681-9800-4579-9553-92ee2e1162df"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "\[CapitalLambda]", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792487097741696*^9, 3.7924871362537193`*^9}, {
  3.792750451045586*^9, 3.7927504511364527`*^9}, {3.7927519641299543`*^9, 
  3.792751983178142*^9}, {3.7928275906639023`*^9, 3.792827593894187*^9}, {
  3.7928316852095203`*^9, 3.792831687425322*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"235062e1-a16a-4f58-8a7a-12c7f73c6327"],

Cell["\<\
The fitness gradient is the derivative of the invasion fitness function with \
respect to the mutant trait value, evaluated at the resident trait value,\
\>", "Text",
 CellChangeTimes->{{3.792487274239406*^9, 
  3.792487293784237*^9}},ExpressionUUID->"af4f63e7-63bf-4740-a107-\
e3d26f3ec082"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grad", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Lambda]", ",", " ", "xm"}], "]"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792487296116774*^9, 3.792487310888296*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"333bb4ca-ae61-4ea6-af93-8b4ebb2a6073"],

Cell[CellGroupData[{

Cell[BoxData["grad"], "Input",
 CellChangeTimes->{{3.792831789198028*^9, 3.7928317893480864`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"17b73bfd-f40e-4e43-b347-e122b6f01c97"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "s"}], " ", 
               SuperscriptBox[
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], "2"]}], "-", 
              RowBox[{"s", " ", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]}]}]], " ", 
            TemplateBox[{"2"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "a", " ", 
               SuperscriptBox["b", "3"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
                SuperscriptBox["0", "\.b2"]]}], "+", 
              TemplateBox[{"161"},
               "OutputSizeLimit`Skeleton"], "+", 
              SqrtBox[
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]]}], ")"}]}], 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"s", " ", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]}]]}], "+", 
              SubscriptBox["N", "1"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               SuperscriptBox["\[ExponentialE]", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]]}], "+", 
              SubscriptBox["N", "1"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               SuperscriptBox["\[ExponentialE]", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]]}], "+", 
              SubscriptBox["N", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"s", " ", 
                 SuperscriptBox[
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], "2"]}]]}], "+", 
              SubscriptBox["N", "2"]}], ")"}]}]], "+", 
          FractionBox[
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]]}],
         Short[#, 10]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{130., {4., 16.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{114., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{164., {0., 23.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 27, 29807097163893941654, 10/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{129., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{185., {0., 23.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 27, 29807097163893941654, 10 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{97., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 27, 29807097163893941654, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{174., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{100., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[29807097163893941654 === $SessionID, 
   Out[27], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.792831791422737*^9, 3.7928341718404512`*^9, 
  3.792924833721375*^9, 
  3.7929271867509623`*^9},ExpressionUUID->"4e947cb6-e112-45bd-9877-\
b0e9bd2123f0"]
}, Open  ]],

Cell[TextData[{
 "Evolutionary singularities are values of ",
 StyleBox["x",
  FontSlant->"Italic"],
 " at which the fitness gradient is zero. However, to evaluate the fitness \
gradient we need the equilibrium population densities of the resident, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "1"], TraditionalForm]],ExpressionUUID->
  "d67ff370-af9a-46cb-95d8-525e4ef3c5d5"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "2"], TraditionalForm]],ExpressionUUID->
  "5ae622bc-2781-46fe-9518-ae7b0ca3a3b8"],
 ", which are also functions of ",
 StyleBox["x",
  FontSlant->"Italic"],
 ". We must therefore solve the ecological and the evolutionary dynamics in \
one step,"
}], "Text",
 CellChangeTimes->{{3.792487646331431*^9, 3.7924877728675747`*^9}, {
  3.792487803290901*^9, 
  3.792487817099244*^9}},ExpressionUUID->"c8a16c0c-ca87-47d2-8842-\
7950a50721aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dynamics", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["dN", "1"], "\[Equal]", " ", 
      SubscriptBox["N", "1"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dN", "2"], "\[Equal]", " ", 
      SubscriptBox["N", "2"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dM", "1"], "\[Equal]", " ", 
      SubscriptBox["M", "1"]}], ",", " ", 
     RowBox[{
      SubscriptBox["dM", "2"], "\[Equal]", " ", 
      SubscriptBox["M", "2"]}], ",", " ", 
     RowBox[{"grad", " ", "\[Equal]", " ", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7924878188689413`*^9, 3.7924878357165623`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"22e62367-bc8a-4645-b651-eb85d70fa789"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["dN", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "1"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dN", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "2"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"x", ",", "x"}], "]"}], 
     SubscriptBox["N", "1"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dM", "1"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "1"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dM", "2"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "m"}], ")"}], 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "2"]}], "+", " ", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"xm", ",", "x"}], "]"}], 
     SubscriptBox["M", "1"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792750520147826*^9, 3.792750520473502*^9}, {
  3.792750580185968*^9, 3.792750614679731*^9}, {3.792750893797038*^9, 
  3.792750893950061*^9}, {3.792751177779767*^9, 3.792751244051896*^9}, {
  3.792751277629825*^9, 3.792751279295052*^9}, {3.792751310717473*^9, 
  3.7927514767360373`*^9}, {3.792752020192103*^9, 3.792752030232621*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"575ea29f-1e94-476f-96e8-72dcdadcdc34"],

Cell["Which can be solved for a given set of parameters.", "Text",
 CellChangeTimes->{{3.792752755945586*^9, 
  3.7927527700550613`*^9}},ExpressionUUID->"84d42271-befd-421b-a035-\
d3d09cb732b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pars", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "100"}], ",", " ", 
     RowBox[{"b", "\[Rule]", "30"}], ",", " ", 
     RowBox[{"h", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"s", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"m", "\[Rule]", "0.01"}], ",", " ", 
     RowBox[{"d", "\[Rule]", "0.2"}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "0.9"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792751568559044*^9, 3.7927516365779123`*^9}, {
   3.79275228862428*^9, 3.792752288647477*^9}, 3.792761468889205*^9, {
   3.7928277821285467`*^9, 3.792827820440106*^9}, {3.792834211361059*^9, 
   3.7928342125432463`*^9}, {3.7929249861621943`*^9, 3.792924986752592*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"f7f4ef76-c4f6-4c4e-8a8c-49acb00f4506"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grad", "/.", "pars"}]], "Input",
 CellChangeTimes->{{3.7929250468193617`*^9, 3.792925051231203*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"4506d6a1-31df-4150-b974-a050e72a01d3"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             TemplateBox[{"20"},
              "OutputSizeLimit`Skeleton"], 
             RowBox[{"-", 
              SuperscriptBox["0", "\.b2"]}]], " ", 
            TemplateBox[{"2"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"(", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"], ")"}]}], 
           RowBox[{"4", " ", 
            TemplateBox[{"3"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"30", " ", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]}], "+", 
              SubscriptBox["N", "2"]}], ")"}]}]], "+", 
          FractionBox[
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{130., {4., 16.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{114., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 30, 29807098808871508685, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{129., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 30, 29807098808871508685, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{97., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 30, 29807098808871508685, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{174., {0., 16.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[29807098808871508685 === $SessionID, 
   Out[30], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.792925048179913*^9, 3.7929250545173607`*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"4a0f2ceb-2e5e-4fcd-a714-f5a5c111d7e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dynamics", "/.", "pars"}], "/.", 
    RowBox[{"xm", "\[Rule]", "x"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "1"], ",", " ", "10000"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "2"], ",", " ", "10000"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "1"], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "2"], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7927515422523327`*^9, 3.792751564352084*^9}, {
  3.7927516465647907`*^9, 3.792751688553184*^9}, {3.7927517728498917`*^9, 
  3.792751781875915*^9}, {3.792752300548695*^9, 3.792752302444861*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f941152e-054a-4f96-b2e1-dafe914c5359"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot","nlnum",
   "\"The function value \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1814.3732761927022`\\\"}], \\\",\\\", RowBox[{\
\\\"-\\\", \\\"1814.373276192703`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"grad\\\"}], \\\"}\\\"}]\\) is not a list of \
numbers with dimensions \\!\\(\\*RowBox[{\\\"{\\\", \\\"5\\\", \\\"}\\\"}]\\) \
at \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{SubscriptBox[\\\"N\\\", \\\"1\\\"], \\\
\",\\\", SubscriptBox[\\\"N\\\", \\\"2\\\"], \\\",\\\", \
SubscriptBox[\\\"M\\\", \\\"1\\\"], \\\",\\\", SubscriptBox[\\\"M\\\", \
\\\"2\\\"], \\\",\\\", \\\"x\\\"}], \\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\
\", RowBox[{\\\"10000.`\\\", \\\",\\\", \\\"10000.`\\\", \\\",\\\", \\\"0.`\\\
\", \\\",\\\", \\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"1.`\\\"}]}], \\\
\"}\\\"}]\\).\"",2,41,1,29807102577240515165,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7928342196803427`*^9, 3.7929248897540703`*^9, 
  3.7929250150495157`*^9, 3.792926877444006*^9},
 CellLabel->
  "During evaluation of \
In[41]:=",ExpressionUUID->"2fe26819-cb05-479c-a57e-a71ca7604889"],

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dynamics", "/.", "\[VeryThinSpace]", "pars"}], "/.", 
    "\[VeryThinSpace]", 
    RowBox[{"xm", "\[Rule]", "x"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "1"], ",", "10000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["N", "2"], ",", "10000"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "1"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["M", "2"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7927533157681637`*^9, 3.792827751678894*^9, {3.7928278026715612`*^9, 
   3.792827822522891*^9}, 3.7928284460160837`*^9, 3.7928342196974363`*^9, 
   3.792924889761157*^9, 3.792925015057766*^9, 3.792926877455532*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"bafcea5b-fc65-4b49-9407-7cefca388e2d"]
}, Open  ]],

Cell[TextData[{
 "Note that when either ",
 StyleBox["y",
  FontSlant->"Italic"],
 " or ",
 StyleBox["\[Alpha]",
  FontSlant->"Italic"],
 " is zero, this model corresponds to the asexual case mentioned before."
}], "Text",
 CellChangeTimes->{{3.792765613546462*^9, 
  3.7927656415548477`*^9}},ExpressionUUID->"6304729f-997c-4771-8b03-\
bb355616bbe2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exploration of parameter space", "Section",
 CellChangeTimes->{{3.792760336406335*^9, 
  3.792760340663501*^9}},ExpressionUUID->"53283b5e-7bfe-48eb-9423-\
5e148337e23f"],

Cell[TextData[{
 "We explore singularities across parameter space using the last model with \
sexual and structured population, of which the one-patch and two-patch \
asexual models are special cases. We vary the habitat symmetry parameter ",
 StyleBox["h",
  FontSlant->"Italic"],
 ", the ecological selection coefficient ",
 StyleBox["s",
  FontSlant->"Italic"],
 ", the dispersal rate ",
 StyleBox["m",
  FontSlant->"Italic"],
 " and the sexual selection coefficient ",
 StyleBox["\[Alpha]",
  FontSlant->"Italic"],
 ". Note that when ",
 StyleBox["m = 0",
  FontSlant->"Italic"],
 " and ",
 StyleBox["h = 0",
  FontSlant->"Italic"],
 " the model corresponds to a one-patch model, and when ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", " ", "=", " ", "0"}], TraditionalForm]],ExpressionUUID->
  "04530c14-b362-4ee8-85a1-d5ff27c67dbd"],
 " the model corresponds to an asexual model (or sexual model with random \
mating). We explore the following values"
}], "Text",
 CellChangeTimes->{{3.792765706610268*^9, 
  3.792765937682535*^9}},ExpressionUUID->"bc45e6bf-3944-4de8-9df2-\
c48b1995263d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hvalues", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "1", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"svalues", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "2", ",", "0.1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mvalues", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.001", ",", "0.01"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avalues", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "10", ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.792765941371689*^9, 3.792766037760944*^9}, {
  3.792826032381174*^9, 3.792826032520801*^9}, {3.79282608098974*^9, 
  3.792826081581153*^9}},ExpressionUUID->"16dc7de3-689a-4936-8fa0-\
6821cdab9ba8"],

Cell["\<\
In addition, there may be multiple singularities for a given parameter set, \
so we repeat the numerical solving procedure with different starting points \
along the trait axis. \
\>", "Text",
 CellChangeTimes->{{3.792826087284349*^9, 
  3.792826103892614*^9}},ExpressionUUID->"d31108ed-dd56-450a-9d63-\
6c82e2f8a571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xvalues", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "0.2"}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"f9fcea25-9f02-4fbc-b130-a296326dced2"],

Cell["\<\
The rest of the parameters is fixed with the following values\
\>", "Text",
 CellChangeTimes->{{3.792766056696369*^9, 
  3.7927660669927073`*^9}},ExpressionUUID->"33f5343d-b0fb-438b-a7f3-\
d238dfef4013"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixed", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", "100"}], ",", 
     RowBox[{"b", "\[Rule]", "30"}], ",", 
     RowBox[{"d", "\[Rule]", "0.2"}], ",", 
     RowBox[{"y", "\[Rule]", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7927660680915422`*^9, 3.7927660869533243`*^9}, {
  3.792766802125598*^9, 
  3.7927668025495167`*^9}},ExpressionUUID->"bc27d7c5-5058-44d2-9a03-\
65279b9b56ae"],

Cell["We first create all parameter combinations", "Text",
 CellChangeTimes->{{3.7927664906304073`*^9, 
  3.792766499286253*^9}},ExpressionUUID->"10bed4af-61cb-4ab4-8ff2-\
6930c4fdd45b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parspace", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{
     "hvalues", ",", "svalues", ",", "mvalues", ",", "avalues", ",", " ", 
      "xvalues"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7927665017999487`*^9, 3.792766526838285*^9}, {
  3.792826019917597*^9, 
  3.792826022741556*^9}},ExpressionUUID->"e0b1557d-0189-4099-a71d-\
a045c931f6a4"],

Cell["\<\
For each parameter combination, we find possible singularities by solving the \
ecological and evolutionary dynamics numerically. For each singularity we \
evaluate convergence stability by computing the derivative of the fitness \
gradient with respect to the resident trait value, evaluated at the \
singularity. We evaluate invasibility, or evolutionary stability, by \
computing the second derivative of the invasion fitness with respect to the \
mutant trait value, evaluated at the singular resident trait value. A \
procedure to efficiently explore singularities across parameter space is the \
following:\
\>", "Text",
 CellChangeTimes->{{3.792766535544607*^9, 3.7927667550545692`*^9}, {
  3.792825479483569*^9, 3.7928254799127207`*^9}, {3.7928256107759037`*^9, 
  3.7928256192564363`*^9}, {3.792826072221093*^9, 3.792826188909021*^9}, {
  3.792826936809444*^9, 
  3.7928269566180058`*^9}},ExpressionUUID->"53bc0630-39be-41c5-a453-\
6e7fc3179d5c"],

Cell[BoxData[
 RowBox[{"SearchSingularities", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", "parspace", "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pars", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"h", "\[Rule]", " ", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"s", "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"m", "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                RowBox[{"\[Alpha]", "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"xstart", " ", "=", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"equil", "=", 
              RowBox[{"FindRoot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"dynamics", "/.", 
                  RowBox[{"xm", "\[Rule]", "x"}]}], "/.", "#"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["N", "1"], ",", " ", "10000"}], "}"}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["N", "2"], ",", " ", "10000"}], "}"}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["M", "1"], ",", " ", "0"}], "}"}], ",", " ", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["M", "2"], ",", " ", "0"}], "}"}], ",", " ", 
                  
                  RowBox[{"{", 
                   RowBox[{"x", ",", " ", "xstart"}], "}"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"convg", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"grad", ",", " ", "x"}], "]"}], "/.", "#"}], "/.", 
               "equil"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"invad", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{"\[Lambda]", ",", "xm"}], "]"}], ",", "xm"}], 
                  "]"}], "/.", 
                 RowBox[{"xm", "\[Rule]", "x"}]}], "/.", "#"}], "/.", 
               "equil"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Sow", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "h", ",", " ", "s", ",", " ", "m", ",", " ", "\[Alpha]"}], 
                  "}"}], "/.", "#"}], ",", "xstart", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["N", "1"], ",", " ", 
                   SubscriptBox["N", "2"], ",", " ", 
                   SubscriptBox["M", "1"], ",", " ", 
                   SubscriptBox["M", "2"], ",", "x"}], "}"}], "/.", "equil"}],
                 ",", "convg", ",", "invad"}], "]"}], "]"}], ";"}], " ", 
            "\[IndentingNewLine]", "}"}], "&"}], "\[IndentingNewLine]", ",", 
          " ", "parspace"}], "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Parallelization", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792766790223353*^9, 3.792766820933*^9}, {
  3.792825486504051*^9, 3.792825491524061*^9}, {3.792825584007362*^9, 
  3.7928256006073513`*^9}, {3.7928256695512047`*^9, 3.792825969359211*^9}, {
  3.792826041790661*^9, 3.792826061340054*^9}, {3.792826215446027*^9, 
  3.792826296891181*^9}, {3.7928263348790617`*^9, 3.792826456324931*^9}, {
  3.792826495293025*^9, 3.792826555806718*^9}, {3.792826655630272*^9, 
  3.7928266866690397`*^9}, {3.792826722971909*^9, 3.792826744832437*^9}, {
  3.792826808083709*^9, 3.7928269286116543`*^9}, {3.7928269635252647`*^9, 
  3.792826964003478*^9}},ExpressionUUID->"8273198a-22fa-40e2-bf0d-\
dded2aed3d50"],

Cell["We deploy this procedure. This may take a while.", "Text",
 CellChangeTimes->{{3.7928269662563667`*^9, 
  3.792826978488412*^9}},ExpressionUUID->"23edc23e-1aa2-41bf-a5af-\
0ce4e2bc2784"],

Cell[BoxData[
 RowBox[{
  RowBox[{"equilibria", "=", 
   RowBox[{"SearchSingularities", "[", "parspace", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792826980226873*^9, 
  3.792826999920703*^9}},ExpressionUUID->"b8c03e67-dfe0-483e-9d6e-\
a4503038e824"],

Cell["We save the output.", "Text",
 CellChangeTimes->{{3.792827003632082*^9, 
  3.7928270067047453`*^9}},ExpressionUUID->"798690a8-c3f5-4eb7-89cb-\
2898ac3c5fdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<adaptive_dynamics_results.csv\>\"", ",", "equilibria"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7928270600429087`*^9, 
  3.79282708615254*^9}},ExpressionUUID->"9df97a3e-9331-4b2b-aded-\
1a31501eb633"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extra", "Section",
 CellChangeTimes->{{3.793097300505163*^9, 
  3.793097300912119*^9}},ExpressionUUID->"3ca9afeb-e30d-4968-b7ac-\
c3a34a4b6ae4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7930973030649652`*^9, 3.7930973047736797`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"92167faa-f743-4ff7-ba7c-47b0fffb18a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"disp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", "m"}], ",", " ", "m"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"m", ",", " ", 
       RowBox[{"1", "-", "m"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.793097312654971*^9, 3.793097389069151*^9}, {
  3.793097450494472*^9, 3.793097451523645*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"22bfc648-79a7-437e-af74-8990743b5666"],

Cell[BoxData[
 RowBox[{
  RowBox[{"growth", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.79309737029628*^9, 3.793097393156311*^9}, {
  3.7930974607243967`*^9, 3.793097461964192*^9}, {3.793097775654372*^9, 
  3.793097782862164*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"0d9a28d0-054c-43e3-a0d9-b85c8b5a98e7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"disp", "//", " ", "MatrixForm"}], ")"}], ".", 
  RowBox[{"(", 
   RowBox[{"growth", "//", "MatrixForm"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7930973961722097`*^9, 3.793097415884644*^9}, {
  3.793097468132267*^9, 3.793097472857544*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"edc4f3e4-72fd-4d82-b871-6ad818dcc28a"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"1", "-", "m"}], "m"},
      {"m", 
       RowBox[{"1", "-", "m"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], ".", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}], "0"},
      {"0", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Output",
 CellChangeTimes->{{3.7930973369569902`*^9, 3.793097348253553*^9}, {
   3.793097383733384*^9, 3.7930974335498*^9}, 3.793097473445735*^9, 
   3.793097702753577*^9, 3.793097785230191*^9, 3.793098216372621*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"1b2db022-412f-4dd2-acc4-c86aa7a794a3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Eigenvectors", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", " ", "b"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"c", ",", " ", "d"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.793099949396831*^9, 3.793099958327346*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"030e6331-222c-43fa-85d6-b1321a1fc1f0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]", " ", "=", " ", 
   RowBox[{"disp", ".", "growth"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", " ", "//", "  ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]", "//", "Eigenvalues"}], "//", 
  "Last"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]", "//", "Eigenvectors"}], "//", "First"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "//", "Transpose"}], "//", "Eigenvectors"}], 
    "//", "First"}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.793099756828412*^9, 3.793099778641674*^9}, {
  3.793099976740838*^9, 3.793100043808228*^9}, {3.7931001309071007`*^9, 
  3.793100159654731*^9}, {3.793100232605504*^9, 3.793100277866613*^9}, {
  3.793100313272728*^9, 3.793100325281163*^9}, {3.793100440478548*^9, 
  3.793100482787813*^9}},ExpressionUUID->"276a40ec-6118-41e5-b92f-\
583d13f5d539"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], 
      RowBox[{"m", " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}]},
     {
      RowBox[{"m", " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.793099779109974*^9, {3.793099978644705*^9, 3.793099995059495*^9}, {
   3.793100026848034*^9, 3.793100047932126*^9}, {3.793100135462749*^9, 
   3.7931001603571377`*^9}, 3.7931002452119827`*^9, 3.793100278286121*^9, 
   3.793100326093843*^9, {3.793100456967951*^9, 3.793100470127461*^9}},
 CellLabel->
  "Out[62]//MatrixForm=",ExpressionUUID->"dd887ea2-ce23-470c-b4dd-\
131b1c3f2021"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"y", ",", "x"}], "]"}], "+", 
         RowBox[{"m", " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"2", " ", "m", " ", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.793099779109974*^9, {3.793099978644705*^9, 3.793099995059495*^9}, {
   3.793100026848034*^9, 3.793100047932126*^9}, {3.793100135462749*^9, 
   3.7931001603571377`*^9}, 3.7931002452119827`*^9, 3.793100278286121*^9, 
   3.793100326093843*^9, {3.793100456967951*^9, 3.793100470130474*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"573b5605-ec0d-4ffa-baff-19145def7a6a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"y", ",", "x"}], "]"}], "-", 
      RowBox[{"m", " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "m"}], "+", 
           SuperscriptBox["m", "2"]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"y", ",", "x"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"y", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "2"]}]}]]}], 
     RowBox[{"2", " ", "m", " ", 
      RowBox[{
       SubscriptBox["r", "1"], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}]]}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.793099779109974*^9, {3.793099978644705*^9, 3.793099995059495*^9}, {
   3.793100026848034*^9, 3.793100047932126*^9}, {3.793100135462749*^9, 
   3.7931001603571377`*^9}, 3.7931002452119827`*^9, 3.793100278286121*^9, 
   3.793100326093843*^9, {3.793100456967951*^9, 3.793100470160551*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"ae326f00-e37a-4129-9d7d-b7f8260e7f68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"y", ",", "x"}], "]"}], "-", 
      RowBox[{"m", " ", 
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"y", ",", "x"}], "]"}]}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "2"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "m"}], "+", 
           SuperscriptBox["m", "2"]}], ")"}], " ", 
         RowBox[{
          SubscriptBox["r", "1"], "[", 
          RowBox[{"y", ",", "x"}], "]"}], " ", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"y", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], "2"]}]}]]}], 
     RowBox[{"2", " ", "m", " ", 
      RowBox[{
       SubscriptBox["r", "2"], "[", 
       RowBox[{"y", ",", "x"}], "]"}]}]]}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.793099779109974*^9, {3.793099978644705*^9, 3.793099995059495*^9}, {
   3.793100026848034*^9, 3.793100047932126*^9}, {3.793100135462749*^9, 
   3.7931001603571377`*^9}, 3.7931002452119827`*^9, 3.793100278286121*^9, 
   3.793100326093843*^9, {3.793100456967951*^9, 3.793100470189316*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"b6e6ac09-9ad7-4655-9813-bd60c43165fc"],

Cell[BoxData[
 SubscriptBox["r", "1"]], "Output",
 CellChangeTimes->{
  3.793099779109974*^9, {3.793099978644705*^9, 3.793099995059495*^9}, {
   3.793100026848034*^9, 3.793100047932126*^9}, {3.793100135462749*^9, 
   3.7931001603571377`*^9}, 3.7931002452119827`*^9, 3.793100278286121*^9, 
   3.793100326093843*^9, {3.793100456967951*^9, 3.793100470192589*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"dbcc8dac-4f61-4933-943e-b874643293ab"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"\[CapitalLambda]", ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.79309823523496*^9, 3.793098240875037*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"f764f544-06e7-46de-aeec-462e22dbba4d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"growth", ",", " ", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.793098327694434*^9, 3.793098330782982*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7a03fee2-ef2d-408b-a399-8028700e8d17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "1"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"y", ",", "x"}], "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "2"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7930982441532516`*^9, 3.793098331334009*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"256d4d88-b2bc-4245-93bc-a64a42bb92b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"\[Lambda]", " ", "=", " ", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "\[CapitalLambda]", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.793097713096723*^9, 3.7930977223544292`*^9}, 
   3.7930982306758623`*^9},ExpressionUUID->"e345716c-7a82-4892-bbd1-\
a923a1a8e0dc"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", "1"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SubscriptBox["r", "2"], "[", 
     RowBox[{"y", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SubscriptBox["r", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{
          SubscriptBox["r", "2"], "[", 
          RowBox[{"y", ",", "x"}], "]"}], "+", 
         RowBox[{"m", " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}], "2"], "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "-", 
         RowBox[{"2", " ", "m", " ", 
          RowBox[{
           SubscriptBox["r", "1"], "[", 
           RowBox[{"y", ",", "x"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["r", "2"], "[", 
           RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7930977228594007`*^9, 3.793097787403551*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"333170b4-a5e4-447d-b865-967f76aeea4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[Lambda]", ",", "y"}], "]"}], "/.", 
   RowBox[{"y", "\[Rule]", "x"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.793097755392598*^9, 3.793097761862605*^9}, {
  3.793097799198729*^9, 3.7930978056040173`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c7e7f6dc-cca1-4349-9736-caf2e7bbc636"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "1"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "1"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["r", "2"], 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "x"}], "]"}], "-", 
    RowBox[{"m", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["r", "2"], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["r", "2"], "[", 
        RowBox[{"x", ",", "x"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "m"}], "+", 
            SuperscriptBox["m", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "1"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "x"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "2"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "1"], "[", 
        RowBox[{"x", ",", "x"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "1"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "x"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "m"}], "+", 
            SuperscriptBox["m", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["r", "2"], 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "x"}], "]"}]}]}], ")"}]}]}], 
     SqrtBox[
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "m"}]}], ")"}], " ", 
        RowBox[{
         SubscriptBox["r", "1"], "[", 
         RowBox[{"x", ",", "x"}], "]"}], " ", 
        RowBox[{
         SubscriptBox["r", "2"], "[", 
         RowBox[{"x", ",", "x"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "1"], "[", 
            RowBox[{"x", ",", "x"}], "]"}], "+", 
           RowBox[{
            SubscriptBox["r", "2"], "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], ")"}], "2"]}]}]]]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.793097791143243*^9, 3.793097806048538*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"e922a140-ae57-4177-973e-e459821e9b28"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", "1"], "=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"y", ",", "x"}], "]"}], 
        RowBox[{"a", "[", 
         RowBox[{"x", ",", "x"}], "]"}]]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["r", "2"], "=", 
   RowBox[{"1", "-", "d", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"y", ",", "x"}], "]"}], 
        RowBox[{"a", "[", 
         RowBox[{"x", ",", "x"}], "]"}]]}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.793097525384015*^9, 3.793097606231698*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"97501f17-064a-4b4d-a76f-a6ce424cb4a0"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.793097646621003*^9, 
  3.7930976934798183`*^9}},ExpressionUUID->"9a0d4a46-b75b-46d1-8e86-\
a28103aacc3c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", 
      RowBox[{"x", ",", "x"}], "]"}], "3"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"]}], "-", 
    RowBox[{"16", " ", "d", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"]}], "-", 
    RowBox[{"16", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"16", " ", "d", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "-", 
    RowBox[{"4", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
     RowBox[{"a", "[", 
      RowBox[{"y", ",", "x"}], "]"}], " ", 
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "-", 
    RowBox[{"4", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
     RowBox[{"a", "[", 
      RowBox[{"y", ",", "x"}], "]"}], " ", 
     RowBox[{
      SubscriptBox["w", "1"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "-", 
    RowBox[{"4", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
     RowBox[{"a", "[", 
      RowBox[{"y", ",", "x"}], "]"}], " ", 
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "-", 
    RowBox[{"4", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", 
       RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
     RowBox[{"a", "[", 
      RowBox[{"y", ",", "x"}], "]"}], " ", 
     RowBox[{
      SubscriptBox["w", "2"], "[", 
      RowBox[{"y", ",", "x"}], "]"}]}], "+", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"]}], "+", 
          RowBox[{"16", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"]}], "+", 
          RowBox[{"16", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"]}], "-", 
          RowBox[{"16", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"4", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"4", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"4", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "3"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"4", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"64", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "-", 
          RowBox[{"128", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "+", 
          RowBox[{"64", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "-", 
          RowBox[{"128", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "+", 
          RowBox[{"256", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "-", 
          RowBox[{"128", " ", 
           SuperscriptBox["d", "2"], " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"64", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"64", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"64", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"64", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"64", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"64", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "d", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"64", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"64", " ", "d", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "6"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"32", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"64", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "5"], " ", 
           RowBox[{"a", "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "+", 
          RowBox[{"16", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "4"], " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"y", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "-", 
          RowBox[{"32", " ", "m", " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"x", ",", "x"}], "]"}], "4"], " ", 
           SuperscriptBox[
            RowBox[{"a", "[", 
             RowBox[{"y", ",", "x"}], "]"}], "2"], " ", 
           RowBox[{
            SubscriptBox["w", "1"], "[", 
            RowBox[{"y", ",", "x"}], "]"}], " ", 
           RowBox[{
            SubscriptBox["w", "2"], "[", 
            RowBox[{"y", ",", "x"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.793097669371011*^9, 3.793097685767726*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"9e07f6e8-b940-47c3-bd1c-9ae0ce26417a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2426, 1329},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>2. Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 174, 3, 198, "Title",ExpressionUUID->"84dec8b2-c688-4eb4-85f0-d40939781ab5"],
Cell[CellGroupData[{
Cell[779, 29, 165, 3, 138, "Section",ExpressionUUID->"8c73b69b-61f6-4a4b-9a00-8a2e97ededab"],
Cell[947, 34, 215, 4, 63, "Input",ExpressionUUID->"f18cc945-6a07-418a-81ce-08cd4d29bda4"],
Cell[1165, 40, 771, 20, 171, "Text",ExpressionUUID->"da17f822-7f14-4d96-94c7-bebb4ac4b2b9"],
Cell[1939, 62, 357, 8, 63, "Input",ExpressionUUID->"86ffc445-ee1e-4f82-ba77-f1d2af9307a1"],
Cell[2299, 72, 467, 15, 73, "Text",ExpressionUUID->"78720b15-e4a2-4fdd-ab65-4284d3e4ef4f"],
Cell[2769, 89, 382, 9, 63, "Input",ExpressionUUID->"bdfb37fb-7795-45fd-b6a7-4ccd27bebfb7"],
Cell[3154, 100, 552, 18, 73, "Text",ExpressionUUID->"ed0a3f17-c0e9-418d-ade1-1f965218bacf"],
Cell[3709, 120, 590, 17, 63, "Input",ExpressionUUID->"0a4fa64b-5058-4da9-9bbc-beef7a4bd525"],
Cell[4302, 139, 1196, 35, 171, "Text",ExpressionUUID->"9a378a22-3125-4236-882f-acccaec36285"],
Cell[5501, 176, 883, 27, 111, "Input",ExpressionUUID->"f57c2f21-692a-4a9d-8108-03f137fc2153"],
Cell[6387, 205, 742, 20, 122, "Text",ExpressionUUID->"959937e3-b810-43a2-bd82-97fc3fdaba39"],
Cell[CellGroupData[{
Cell[7154, 229, 1161, 33, 158, "Input",ExpressionUUID->"d2c811c2-82be-46f8-8f92-c1aa0e38adfc"],
Cell[8318, 264, 920, 24, 133, "Output",ExpressionUUID->"768e77c3-4473-4ad5-a4b4-9a24a31a0f81"]
}, Open  ]],
Cell[9253, 291, 171, 3, 73, "Text",ExpressionUUID->"07043a38-ccbf-413b-a095-4f097957f42b"],
Cell[9427, 296, 737, 24, 122, "Input",ExpressionUUID->"63c6cb21-962d-4d57-ac76-9d6d22e7f8f3"],
Cell[10167, 322, 275, 6, 73, "Text",ExpressionUUID->"42bb344b-d95a-4d0b-8eac-b9eea8b52be7"],
Cell[10445, 330, 394, 8, 63, "Input",ExpressionUUID->"49dc744f-72eb-44ac-bf6a-7fb12a980266"],
Cell[10842, 340, 288, 6, 73, "Text",ExpressionUUID->"fbf71420-6237-4183-a16d-e8143867a24b"],
Cell[11133, 348, 354, 8, 63, "Input",ExpressionUUID->"da2c8f8b-b9e4-4180-85a7-7acaba99b6b7"],
Cell[11490, 358, 459, 11, 122, "Text",ExpressionUUID->"df5b2abe-ef83-4fc0-9c6c-2c6b6e350c35"],
Cell[11952, 371, 742, 20, 158, "Input",ExpressionUUID->"9b18e44b-5054-4e9c-a37f-66a5df97079b"],
Cell[12697, 393, 197, 3, 73, "Text",ExpressionUUID->"9f9ddaa3-e646-4724-8fca-03ee9a2e334f"],
Cell[12897, 398, 532, 12, 63, "Input",ExpressionUUID->"749e56df-5e3a-4817-91fd-0364bc029306"],
Cell[CellGroupData[{
Cell[13454, 414, 746, 18, 63, "Input",ExpressionUUID->"35c61bbc-2d02-49e6-85ff-841bdce8479b"],
Cell[14203, 434, 575, 12, 102, "Output",ExpressionUUID->"25d74fcd-45f0-43a7-b71d-e1c7a8f78f65"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14827, 452, 166, 3, 138, "Section",ExpressionUUID->"659977b2-8cf1-434e-8134-380101cb296f"],
Cell[14996, 457, 215, 4, 63, "Input",ExpressionUUID->"17bce07e-2ed3-4050-aed0-a1e7f896d69f"],
Cell[15214, 463, 782, 14, 171, "Text",ExpressionUUID->"2c8466ca-81c1-41ba-a526-d41f77f86a9c"],
Cell[CellGroupData[{
Cell[16021, 481, 1473, 42, 158, "Input",ExpressionUUID->"5d378a3a-e610-499e-b785-4bbd27df7ee9"],
Cell[17497, 525, 1621, 49, 133, "Output",ExpressionUUID->"258c6831-20db-4271-9a43-3e5d30dd6b37"]
}, Open  ]],
Cell[19133, 577, 746, 22, 124, "Text",ExpressionUUID->"32681117-2426-4037-b3e2-63a3bfe14e86"],
Cell[19882, 601, 787, 21, 111, "Input",ExpressionUUID->"0019ea19-8085-4960-9ea4-4141dee15c1b"],
Cell[20672, 624, 873, 28, 124, "Text",ExpressionUUID->"40af5ce1-4ae6-417b-9cad-bdb00a05b337"],
Cell[21548, 654, 1156, 36, 111, "Input",ExpressionUUID->"0aea77f7-b487-4744-bd7d-557cb9452c47"],
Cell[22707, 692, 713, 19, 124, "Text",ExpressionUUID->"2a0c6e71-f369-40e5-92db-f5335c916cd3"],
Cell[23423, 713, 1894, 56, 205, "Input",ExpressionUUID->"f7a77f8f-67e6-4650-89f7-4a2346b19575"],
Cell[25320, 771, 669, 18, 122, "Text",ExpressionUUID->"b61f11c5-658d-4ac7-9b93-0f606d9f8e17"],
Cell[CellGroupData[{
Cell[26014, 793, 1767, 52, 252, "Input",ExpressionUUID->"4f0b6352-a739-4a4f-8bc2-a902fec4aca8"],
Cell[27784, 847, 3144, 98, 160, "Output",ExpressionUUID->"6e6c1ac2-d1b6-4e30-b4bf-ba0c0c1c8df8"]
}, Open  ]],
Cell[30943, 948, 494, 7, 73, "Text",ExpressionUUID->"1b853e43-dca9-4bf0-aeee-ce87c894c597"],
Cell[31440, 957, 736, 24, 122, "Input",ExpressionUUID->"fb95c365-71fa-4093-a425-b3dbc0553bd3"],
Cell[32179, 983, 288, 7, 73, "Text",ExpressionUUID->"c1b27ae4-3c6e-43b9-908a-0e4d34172d0b"],
Cell[32470, 992, 525, 10, 63, "Input",ExpressionUUID->"a1ad1492-5b4e-418d-881c-c4fa381884c1"],
Cell[32998, 1004, 302, 6, 73, "Text",ExpressionUUID->"380a5d60-f097-4eac-9002-c4f9256ab385"],
Cell[33303, 1012, 352, 8, 63, "Input",ExpressionUUID->"c32bbc21-ec7f-41a4-8dcc-52fdfe3fefe1"],
Cell[33658, 1022, 874, 24, 122, "Text",ExpressionUUID->"09d1db8e-f127-435b-b992-613e5a54a8dd"],
Cell[34535, 1048, 2877, 89, 252, "Input",ExpressionUUID->"5fe5bb3a-b72c-4e45-853e-cc82346df9d0"],
Cell[37415, 1139, 235, 6, 73, "Text",ExpressionUUID->"ef55aabf-1a4b-4774-a545-7c31990db4ab"],
Cell[37653, 1147, 612, 13, 63, "Input",ExpressionUUID->"8f09c612-7a3e-4150-9429-ba7f2ffb5f4e"],
Cell[CellGroupData[{
Cell[38290, 1164, 1005, 26, 63, "Input",ExpressionUUID->"e3324da8-1dd8-4c2b-9a10-a4cdee0e476e"],
Cell[39298, 1192, 554, 13, 108, "Output",ExpressionUUID->"6c2c952d-8d36-43a0-a13f-aa8b227b9c33"]
}, Open  ]],
Cell[39867, 1208, 343, 9, 73, "Text",ExpressionUUID->"7425d7c3-5fae-4034-88eb-7a7f8440ae38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40247, 1222, 213, 4, 138, "Section",ExpressionUUID->"47d5bcdb-6be7-474b-99e5-ca4db4a9132b"],
Cell[40463, 1228, 219, 4, 63, "Input",ExpressionUUID->"e45eb4aa-855a-4fb6-9acf-687b8231b2de"],
Cell[40685, 1234, 1225, 19, 220, "Text",ExpressionUUID->"4be7d716-5a67-4be4-919f-7514a23138f1"],
Cell[41913, 1255, 449, 12, 63, "Input",ExpressionUUID->"4b19338b-7f35-465f-b4a1-1db43c06c28f"],
Cell[42365, 1269, 534, 15, 63, "Input",ExpressionUUID->"5a726d86-1b6c-4bee-9491-97d5be51064d"],
Cell[CellGroupData[{
Cell[42924, 1288, 479, 10, 111, "Input",ExpressionUUID->"3369ffbb-acdd-4c2c-95b9-2aaf311e2741"],
Cell[43406, 1300, 1347, 40, 133, "Output",ExpressionUUID->"fd144ecd-27fd-4345-9653-f5dcfcd2a14a"]
}, Open  ]],
Cell[44768, 1343, 422, 8, 122, "Text",ExpressionUUID->"8a8ce5e9-40f0-403a-b8db-76d2d6556410"],
Cell[CellGroupData[{
Cell[45215, 1355, 236, 4, 63, "Input",ExpressionUUID->"cc3feb21-02ce-451b-9646-ec4d3e0b57e3"],
Cell[45454, 1361, 1394, 48, 108, "Output",ExpressionUUID->"7d178bb8-0b50-410f-88fc-3342cb26ce75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46885, 1414, 233, 3, 63, "Input",ExpressionUUID->"6e34851b-1cbf-4476-b009-ea794f56ea51"],
Cell[47121, 1419, 4918, 134, 405, "Output",ExpressionUUID->"84314801-c657-4ae5-8fdb-c39312298ebf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52076, 1558, 280, 5, 63, "Input",ExpressionUUID->"cc5e3d83-aea7-498c-bfdd-026cb4769777"],
Cell[52359, 1565, 4918, 134, 405, "Output",ExpressionUUID->"f8fae230-a8ad-4c05-8125-6033d9e324ce"]
}, Open  ]],
Cell[57292, 1702, 581, 14, 63, "Input",ExpressionUUID->"5148ad25-33cf-4cad-8e38-8affd50d1b5b"],
Cell[CellGroupData[{
Cell[57898, 1720, 307, 6, 63, "Input",ExpressionUUID->"33ee32a7-c1b3-4df9-913a-69cb30c78424"],
Cell[58208, 1728, 1499, 46, 207, "Output",ExpressionUUID->"0c9220b4-3dbe-490c-9ca2-67df5663a036"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59744, 1779, 286, 6, 63, "Input",ExpressionUUID->"1679b0f8-2181-47e0-8240-28f1934491e4"],
Cell[60033, 1787, 5646, 173, 335, "Output",ExpressionUUID->"0c370713-c2d5-4dfc-bb08-543f3699088b"]
}, Open  ]],
Cell[65694, 1963, 206, 4, 63, "Input",ExpressionUUID->"4950832e-55e9-456b-9eac-5a2fd66a9a4f"],
Cell[CellGroupData[{
Cell[65925, 1971, 1553, 42, 158, "Input",ExpressionUUID->"99a62d76-f3c6-4cab-b946-59630548c1eb"],
Cell[67481, 2015, 4057, 110, 187, "Output",ExpressionUUID->"db67ac8d-0c63-4777-82bf-bdb31689b1bc"]
}, Open  ]],
Cell[71553, 2128, 619, 18, 73, "Text",ExpressionUUID->"2f2be72c-2389-4f74-b301-03f159c3881d"],
Cell[72175, 2148, 1404, 42, 206, "Input",ExpressionUUID->"87eb45e7-ac6f-4a3a-8909-697388a7e317"],
Cell[CellGroupData[{
Cell[73604, 2194, 246, 5, 63, "Input",ExpressionUUID->"67d19bd6-cca0-4d8d-90c2-de3b1f758e17"],
Cell[73853, 2201, 278, 6, 102, "Output",ExpressionUUID->"83bc19c9-f58f-464c-87ea-0cde9c1302f0"]
}, Open  ]],
Cell[74146, 2210, 435, 12, 69, "Input",ExpressionUUID->"28559623-e018-4034-8a57-e74481db1ed6"],
Cell[CellGroupData[{
Cell[74606, 2226, 499, 12, 63, "Input",ExpressionUUID->"8ac0f573-a21f-4354-b89c-b46d9297817a"],
Cell[75108, 2240, 5525, 175, 282, "Output",ExpressionUUID->"29b0f5a1-b668-4314-97ae-ddaa7857ccc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80670, 2420, 732, 18, 111, "Input",ExpressionUUID->"045c90aa-a5bd-4432-a579-e547468d0aec"],
Cell[81405, 2440, 523, 13, 102, "Output",ExpressionUUID->"84ba72bc-27e3-483c-95f5-4efc76533b32"],
Cell[81931, 2455, 683, 19, 102, "Output",ExpressionUUID->"41a29406-736c-4f02-95f8-c5e767faa42f"]
}, Open  ]],
Cell[82629, 2477, 129, 3, 63, "Input",ExpressionUUID->"90ab3545-a1ee-4e4b-b8cd-ec3b2fc83cca"],
Cell[82761, 2482, 167, 4, 63, "Input",ExpressionUUID->"ed3e1472-807c-4372-90ac-6cd9e1c245ef"],
Cell[CellGroupData[{
Cell[82953, 2490, 989, 29, 158, "Input",ExpressionUUID->"5154c2a0-871d-4ba2-9b78-48b6da5a1a4a"],
Cell[83945, 2521, 6314, 178, 300, "Output",ExpressionUUID->"2ac75176-c3cb-4d13-86cd-6c13932a7a04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90296, 2704, 890, 19, 252, "Input",ExpressionUUID->"9bfdda38-ec28-4a79-b2b8-670d82a0d9f7"],
Cell[91189, 2725, 1086, 31, 148, "Output",ExpressionUUID->"113775c4-7bf5-41db-895e-2cb76b0ca38a"],
Cell[92278, 2758, 1088, 31, 148, "Output",ExpressionUUID->"8ef15fe5-31f6-4fc3-ba34-2bb6fd371376"],
Cell[93369, 2791, 910, 25, 134, "Output",ExpressionUUID->"ccb76462-bef3-4c43-82e7-b0ebb5dc98eb"],
Cell[94282, 2818, 332, 7, 102, "Output",ExpressionUUID->"ae396e80-df1f-479e-9f31-2db07e665a8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94651, 2830, 1874, 53, 299, "Input",ExpressionUUID->"6c593b33-ad94-4043-a8d3-b94a9e1a460f"],
Cell[96528, 2885, 1832, 58, 155, "Output",ExpressionUUID->"aceb1620-a6aa-42b9-acb0-b52be1b3f203"],
Cell[98363, 2945, 1832, 58, 155, "Output",ExpressionUUID->"94343916-d45c-456b-b093-dba5b20d2fb8"],
Cell[100198, 3005, 1509, 49, 131, "Output",ExpressionUUID->"97e67a3c-33aa-4894-98e7-3e8cd6b495ce"],
Cell[101710, 3056, 1510, 49, 131, "Output",ExpressionUUID->"4905f7a3-b9fe-416c-8d14-056bfb18a50d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103257, 3110, 1405, 41, 205, "Input",ExpressionUUID->"9a649b26-581f-47b9-a300-9eeecab9c3a2"],
Cell[104665, 3153, 15001, 418, 735, "Output",ExpressionUUID->"4c3ff84c-2030-4a81-97fe-89ad3a0916ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119703, 3576, 576, 19, 111, "Input",ExpressionUUID->"dc2375cd-f080-42ab-a143-e91f964274d4"],
Cell[120282, 3597, 1022, 31, 148, "Output",ExpressionUUID->"4c4081d3-2466-45bb-84c1-d956206a341e"],
Cell[121307, 3630, 844, 25, 134, "Output",ExpressionUUID->"8325a858-1568-4eda-89dd-c8286317dce8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122188, 3660, 1148, 37, 158, "Input",ExpressionUUID->"23f6822f-3561-4904-9a4b-dd99a745bbcb"],
Cell[123339, 3699, 180, 2, 102, "Output",ExpressionUUID->"8d696b14-483d-4b48-b9b6-642ed7673911"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123556, 3706, 152, 3, 63, "Input",ExpressionUUID->"b509f4f0-268c-4a94-b0f4-e55ebb540872"],
Cell[123711, 3711, 1835, 58, 155, "Output",ExpressionUUID->"65c2daa2-53b7-4991-9105-85686e4aefc9"],
Cell[125549, 3771, 1834, 58, 155, "Output",ExpressionUUID->"b5c843ff-2e60-4b80-9f16-86b5c4ad8028"],
Cell[127386, 3831, 1510, 49, 131, "Output",ExpressionUUID->"96e9b297-5d8a-4d70-908c-1d722aa970e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128933, 3885, 857, 24, 63, "Input",ExpressionUUID->"25b08a94-b4fb-40d7-a459-6b3c432a96b0"],
Cell[129793, 3911, 434, 11, 102, "Output",ExpressionUUID->"411585ef-9654-4198-b66f-ed67e1206b09"]
}, Open  ]],
Cell[130242, 3925, 154, 3, 63, InheritFromParent,ExpressionUUID->"5ac7bf77-cba1-4b0f-b8de-9fe9756b9a3a"],
Cell[CellGroupData[{
Cell[130421, 3932, 421, 10, 63, "Input",ExpressionUUID->"36541878-1120-4828-90b1-c517e33a1191"],
Cell[130845, 3944, 530, 16, 112, "Output",ExpressionUUID->"76ebdd22-163c-4078-b863-cb86dc30cc35"]
}, Open  ]],
Cell[131390, 3963, 3639, 103, 379, "Text",ExpressionUUID->"c7455f3f-a1c5-42f5-9fba-b0042b219a95"],
Cell[135032, 4068, 225, 4, 73, "Text",ExpressionUUID->"42f13714-ba03-436d-8dbc-f1bf2499c9f9"],
Cell[135260, 4074, 766, 18, 99, "Input",ExpressionUUID->"28e242f4-ea87-43f3-9d69-a72604988815"],
Cell[136029, 4094, 741, 18, 122, "Text",ExpressionUUID->"7867d24b-4bea-4aad-bdc7-9d029e748f76"],
Cell[136773, 4114, 1211, 37, 111, "Input",ExpressionUUID->"7c2a5d30-3da5-482d-b49b-fa7497bc8052"],
Cell[137987, 4153, 518, 10, 122, "Text",ExpressionUUID->"2dd54106-a119-4edf-8276-a1e8fdb237f4"],
Cell[CellGroupData[{
Cell[138530, 4167, 244, 5, 63, "Input",ExpressionUUID->"217a4f24-c622-465d-b5f6-4e76c18b19d7"],
Cell[138777, 4174, 451, 13, 102, "Output",ExpressionUUID->"a62a2e26-dd58-41e4-8f06-0fb769b5293b"]
}, Open  ]],
Cell[139243, 4190, 1618, 52, 205, "Input",ExpressionUUID->"59250d04-f14e-4c5f-af9a-edeba6090cca"],
Cell[140864, 4244, 264, 6, 73, "Text",ExpressionUUID->"83c16ba1-20d1-4410-9ea9-123952a6f4c1"],
Cell[CellGroupData[{
Cell[141153, 4254, 1720, 49, 252, "Input",ExpressionUUID->"b1ede9d4-62d7-43f3-b98a-66a67b9370d6"],
Cell[142876, 4305, 1302, 40, 133, "Output",ExpressionUUID->"23888485-c382-4df3-97e9-dff7de97ab64"]
}, Open  ]],
Cell[144193, 4348, 222, 4, 73, "Text",ExpressionUUID->"e59fa965-b1a7-4aed-9ab1-eb6f1676a3ad"],
Cell[144418, 4354, 680, 23, 122, "Input",ExpressionUUID->"f2a4192b-65d5-4679-81af-b9c08c82f2ff"],
Cell[145101, 4379, 249, 6, 73, "Text",ExpressionUUID->"0933e283-68bf-438e-9daf-c7c679016108"],
Cell[CellGroupData[{
Cell[145375, 4389, 244, 5, 63, "Input",ExpressionUUID->"1dcf177e-680e-403c-b69d-e1399aea6e42"],
Cell[145622, 4396, 1194, 39, 160, "Output",ExpressionUUID->"d1526681-9800-4579-9553-92ee2e1162df"]
}, Open  ]],
Cell[146831, 4438, 542, 10, 63, "Input",ExpressionUUID->"235062e1-a16a-4f58-8a7a-12c7f73c6327"],
Cell[147376, 4450, 302, 6, 73, "Text",ExpressionUUID->"af4f63e7-63bf-4740-a107-e3d26f3ec082"],
Cell[147681, 4458, 352, 8, 63, "Input",ExpressionUUID->"333bb4ca-ae61-4ea6-af93-8b4ebb2a6073"],
Cell[CellGroupData[{
Cell[148058, 4470, 177, 2, 63, "Input",ExpressionUUID->"17b73bfd-f40e-4e43-b347-e122b6f01c97"],
Cell[148238, 4474, 11471, 299, 242, "Output",ExpressionUUID->"4e947cb6-e112-45bd-9877-b0e9bd2123f0"]
}, Open  ]],
Cell[159724, 4776, 874, 24, 122, "Text",ExpressionUUID->"c8a16c0c-ca87-47d2-8842-7950a50721aa"],
Cell[160601, 4802, 742, 19, 63, "Input",ExpressionUUID->"22e62367-bc8a-4645-b651-eb85d70fa789"],
Cell[161346, 4823, 2228, 70, 205, "Input",ExpressionUUID->"575ea29f-1e94-476f-96e8-72dcdadcdc34"],
Cell[163577, 4895, 194, 3, 73, "Text",ExpressionUUID->"84d42271-befd-421b-a035-d3d09cb732b8"],
Cell[163774, 4900, 815, 16, 63, "Input",ExpressionUUID->"f7f4ef76-c4f6-4c4e-8a8c-49acb00f4506"],
Cell[CellGroupData[{
Cell[164614, 4920, 203, 3, 63, "Input",ExpressionUUID->"4506d6a1-31df-4150-b974-a050e72a01d3"],
Cell[164820, 4925, 9591, 251, 237, "Output",ExpressionUUID->"4a0f2ceb-2e5e-4fcd-a714-f5a5c111d7e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174448, 5181, 1005, 26, 63, "Input",ExpressionUUID->"f941152e-054a-4f96-b2e1-dafe914c5359"],
Cell[175456, 5209, 1181, 20, 46, "Message",ExpressionUUID->"2fe26819-cb05-479c-a57e-a71ca7604889"],
Cell[176640, 5231, 1024, 28, 102, "Output",ExpressionUUID->"bafcea5b-fc65-4b49-9407-7cefca388e2d"]
}, Open  ]],
Cell[177679, 5262, 350, 11, 73, "Text",ExpressionUUID->"6304729f-997c-4771-8b03-bb355616bbe2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178066, 5278, 175, 3, 138, "Section",ExpressionUUID->"53283b5e-7bfe-48eb-9423-5e148337e23f"],
Cell[178244, 5283, 1100, 31, 220, "Text",ExpressionUUID->"bc45e6bf-3944-4de8-9df2-c48b1995263d"],
Cell[179347, 5316, 801, 23, 205, "Input",ExpressionUUID->"16dc7de3-689a-4936-8fa0-6821cdab9ba8"],
Cell[180151, 5341, 328, 7, 122, "Text",ExpressionUUID->"d31108ed-dd56-450a-9d63-6c82e2f8a571"],
Cell[180482, 5350, 242, 6, 63, "Input",ExpressionUUID->"f9fcea25-9f02-4fbc-b130-a296326dced2"],
Cell[180727, 5358, 213, 5, 73, "Text",ExpressionUUID->"33f5343d-b0fb-438b-a7f3-d238dfef4013"],
Cell[180943, 5365, 454, 12, 63, "Input",ExpressionUUID->"bc27d7c5-5058-44d2-9a03-65279b9b56ae"],
Cell[181400, 5379, 186, 3, 73, "Text",ExpressionUUID->"10bed4af-61cb-4ab4-8ff2-6930c4fdd45b"],
Cell[181589, 5384, 414, 11, 63, "Input",ExpressionUUID->"e0b1557d-0189-4099-a71d-a045c931f6a4"],
Cell[182006, 5397, 965, 16, 220, "Text",ExpressionUUID->"53bc0630-39be-41c5-a453-6e7fc3179d5c"],
Cell[182974, 5415, 4921, 110, 863, "Input",ExpressionUUID->"8273198a-22fa-40e2-bf0d-dded2aed3d50"],
Cell[187898, 5527, 192, 3, 73, "Text",ExpressionUUID->"23edc23e-1aa2-41bf-a5af-0ce4e2bc2784"],
Cell[188093, 5532, 256, 6, 63, "Input",ExpressionUUID->"b8c03e67-dfe0-483e-9d6e-a4503038e824"],
Cell[188352, 5540, 163, 3, 73, "Text",ExpressionUUID->"798690a8-c3f5-4eb7-89cb-2898ac3c5fdb"],
Cell[188518, 5545, 277, 7, 63, "Input",ExpressionUUID->"9df97a3e-9331-4b2b-aded-1a31501eb633"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188832, 5557, 150, 3, 138, "Section",ExpressionUUID->"3ca9afeb-e30d-4968-b7ac-c3a34a4b6ae4"],
Cell[188985, 5562, 219, 4, 63, "Input",ExpressionUUID->"92167faa-f743-4ff7-ba7c-47b0fffb18a9"],
Cell[189207, 5568, 499, 13, 63, "Input",ExpressionUUID->"22bfc648-79a7-437e-af74-8990743b5666"],
Cell[189709, 5583, 665, 18, 63, "Input",ExpressionUUID->"0d9a28d0-054c-43e3-a0d9-b85c8b5a98e7"],
Cell[CellGroupData[{
Cell[190399, 5605, 371, 8, 63, "Input",ExpressionUUID->"edc4f3e4-72fd-4d82-b871-6ad818dcc28a"],
Cell[190773, 5615, 1510, 43, 133, "Output",ExpressionUUID->"1b2db022-412f-4dd2-acc4-c86aa7a794a3"]
}, Open  ]],
Cell[192298, 5661, 346, 8, 63, "Input",ExpressionUUID->"030e6331-222c-43fa-85d6-b1321a1fc1f0"],
Cell[CellGroupData[{
Cell[192669, 5673, 1051, 24, 346, "Input",ExpressionUUID->"276a40ec-6118-41e5-b92f-583d13f5d539"],
Cell[193723, 5699, 1471, 43, 133, "Output",ExpressionUUID->"dd887ea2-ce23-470c-b4dd-131b1c3f2021"],
Cell[195197, 5744, 2105, 62, 131, "Output",ExpressionUUID->"573b5605-ec0d-4ffa-baff-19145def7a6a"],
Cell[197305, 5808, 2097, 61, 155, "Output",ExpressionUUID->"ae326f00-e37a-4129-9d7d-b7f8260e7f68"],
Cell[199405, 5871, 2097, 61, 155, "Output",ExpressionUUID->"b6e6ac09-9ad7-4655-9813-bd60c43165fc"],
Cell[201505, 5934, 439, 7, 102, "Output",ExpressionUUID->"dbcc8dac-4f61-4933-943e-b874643293ab"]
}, Open  ]],
Cell[201959, 5944, 235, 4, 63, "Input",ExpressionUUID->"f764f544-06e7-46de-aeec-462e22dbba4d"],
Cell[CellGroupData[{
Cell[202219, 5952, 231, 4, 63, "Input",ExpressionUUID->"7a03fee2-ef2d-408b-a399-8028700e8d17"],
Cell[202453, 5958, 795, 26, 108, "Output",ExpressionUUID->"256d4d88-b2bc-4245-93bc-a64a42bb92b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203285, 5989, 365, 8, 111, "Input",ExpressionUUID->"e345716c-7a82-4892-bbd1-a923a1a8e0dc"],
Cell[203653, 5999, 1860, 58, 131, "Output",ExpressionUUID->"333170b4-a5e4-447d-b865-967f76aeea4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205550, 6062, 369, 8, 63, "Input",ExpressionUUID->"c7e7f6dc-cca1-4349-9736-caf2e7bbc636"],
Cell[205922, 6072, 4367, 144, 289, "Output",ExpressionUUID->"e922a140-ae57-4177-973e-e459821e9b28"]
}, Open  ]],
Cell[210304, 6219, 1078, 35, 205, "Input",ExpressionUUID->"97501f17-064a-4b4d-a76f-a6ce424cb4a0"],
Cell[CellGroupData[{
Cell[211407, 6258, 154, 3, 63, "Input",ExpressionUUID->"9a0d4a46-b75b-46d1-8e86-a28103aacc3c"],
Cell[211564, 6263, 14838, 405, 598, "Output",ExpressionUUID->"9e07f6e8-b940-47c3-bd1c-9ae0ce26417a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

